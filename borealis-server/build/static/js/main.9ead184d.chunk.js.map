{"version":3,"sources":["redux/constants.js","reducers/settingsReducer.js","reducers/metadataReducer.js","controllers/guid.js","reducers/gameReducer.js","hooks/useSocket.js","contexts/WebSocketProvider.js","controllers/drawImage.js","hooks/useCanvas.js","components/Canvas.js","components/Background.js","components/Drawing.js","components/Fog.js","components/Overlay.js","views/TokenView.js","components/Token.js","views/Cursor.js","views/Button.js","components/ToggleButton.js","views/ToolControlsView.js","components/ToolControls.js","views/MapConfigView.js","components/MapConfig.js","views/MapToolView.js","components/MapTool.js","views/HostTokenConfigView.js","views/GuestTokenConfigView.js","components/TokenConfig.js","views/TokenToolView.js","views/SelectedTokensControlsView.js","components/SelectedTokensControls.js","components/TokenTool.js","views/UserToolView.js","components/UserTool.js","components/ToolButton.js","views/ToolSelectView.js","views/ControlPanelView.js","components/ControlPanel.js","views/GameView.js","components/Game.js","components/App.js","serviceWorker.js","index.js"],"names":["CHANGE_CURSORSIZE","CHANGE_FOG_SETTINGS","CHANGE_DRAW_SETTINGS","CHANGE_TOOL","CHANGE_USERNAME","TOGGLE_MOUSESHARING","OVERWRITE_GAME","LOAD_MAP","INCREMENT_GEN","SET_FOG_ENABLED","SET_ISFOGLOADED","SET_ISFIRSTLOADDONE","UPDATE_MAPS","ADD_MAP","DELETE_MAP","UPDATE_TOKENS","ADD_TOKEN","DELETE_TOKEN","COPY_TOKEN","UPDATE_TOKEN_VALUE","TOGGLE_TOKEN_VALUE","RESET_FOG","RESET_DRAW","SET_GAMESETTINGS","SET_CURSORS","SET_LAST_COORDINATES","SET_DOWN_COORDINATES","initialSettingsState","cursorSize","fogOpacity","fogRadius","drawColor","drawSize","tool","subtool","undefined","username","URLSearchParams","window","location","href","replace","get","shareMouse","setCursorSize","newCursorSize","type","parseInt","setToolSettings","newTool","newSubtool","setUsername","newUsername","settingsReducer","state","action","initialMetadataState","isHost","room","cursors","lastX","lastY","downX","downY","metadataReducer","guid","c","r","crypto","getRandomValues","Uint32Array","Math","pow","toString","initialGameState","mapId","gen","width","innerWidth","height","innerHeight","fogEnabled","isFogLoaded","isFirstLoadDone","maps","tokens","loadMap","newMapId","setFogEnabled","newFogEnabled","updateMaps","newMaps","addMap","mapName","map","name","$id","imageUrl","x","y","drawPaths","fogPaths","updateTokens","newTokens","gameReducer","JSON","parse","stringify","game","isNaN","length","mapsWithNewMap","concat","filter","token","tokenGuid","tokenCopy","tokensCopy","key","value","tokensCopy2","fogResetMaps","drawResetMaps","useWebSocket","useContext","WebSocketContext","sendData","webSocket","data","readyState","WebSocket","OPEN","send","console","error","pushGameRefresh","wsSettings","additionalAttributes","from","requestRefresh","require","config","process","PORT","createWebSocket","webSocketUrl","host","protocol","test","generateWebSocketUrl","createContext","connect","metadata","children","useState","setWsSettings","ws","setWs","useEffect","onClose","setTimeout","log","onOpen","onError","err","addEventListener","removeEventListener","Provider","drawImage","url","which","context","resizeCanvases","trim","Promise","resolve","reject","ctx","img","Image","onload","w","h","then","onerror","src","useCanvas","draw","gameState","options","canvasRef","useRef","current","getContext","Canvas","id","rest","ref","mapDispatchToProps","onClick","e","currMap","getMap","currPath","globalCompositeOperation","beginPath","pointId","lineCap","fillStyle","lineWidth","strokeStyle","moveTo","lineTo","erease","className","clearRect","pathId","stroke","settings","ereaseFog","gradient","createRadialGradient","r2","addColorStop","fillRect","style","opacity","overlayRef","TokenView","divStyle","classes","imgStyle","onMouseDown","onMouseUp","title","join","alt","ko","pc","$selected","left","top","Cursor","cursor","size","fontSize","role","u","Button","isSelected","disabled","ToggleButton","controlPanelState","setControlPanelState","toggleKey","ToolControlsView","setDrawColor","setDrawSize","setFogOpacity","setFogRadius","setSubtool","resetFog","resetDrawing","onChange","target","step","min","backgroundColor","max","setDrawToolSettings","newDrawColor","newDrawSize","setFogToolSettings","newFogOpacity","newFogRadius","resetDraw","newSize","newOpacity","newRadius","MapConfigView","mapConfigState","load","onTextChange","onIntegerChange","deleteMap","placeholder","mapIdToDelete","setIsFogLoaded","newIsFogLoaded","setIsFirstLoadDone","newIsFirstLoadDone","existingMap","mapElement","currentMap","initialMapConfigState","setMapConfigState","updatedMaps","pushMapState","evt","confirm","MapToolView","newMapName","setNewMapName","createMap","toggleOnMaps","newWidth","newHeight","pushCreateMap","HostTokenConfigView","copy","onToggle","selectToken","onMapSelect","deleteToken","defaultValue","GuestTokenConfigView","tokenGuidToDelete","copyToken","tokenGuidToCopy","updateTokenValue","tokenGuidToUpdate","toggleTokenValue","tokenSelected","updatedTokens","currToken","$x0","$y0","TokenToolView","newTokenUrl","setNewTokenUrl","createToken","$i","SelectedTokensControlsView","filteredTokens","t","addToken","tokenName","tokenUrl","newToken","toggleOnTokens","UserToolView","initAsDev","toggleFog","copyJson","pasteJson","updateUsername","updateCursorSize","toggleOnUser","pushFogEnabled","ToolSelectView","ControlPanelView","hidden","toggleHidden","socketRequestRefresh","pushRefreshToPlayers","initialControlPanelState","GameView","onMouseMove","goneClass","setGameSettings","newIsHost","newRoom","overwriteGame","newGame","incrementGen","React","currentPath","setPointerOutline","color","radius","arc","PI","closePath","onResize","onKeyDown","currentTool","isEraser","saveToLocalStorage","receiveData","useCallback","to","newDrawPath","push","drawPath","updatedMapsWithDraw","updatedMapsWithDrawReset","newFogPath","fogPath","updatedMapsWithFog","updatedMapsWithFogReset","params","document","deadline","Date","cursorsCopy","time","clearOverlay","pageX","pageY","updateCurrentFogPath","updateCurrentDrawPath","buttons","pushFogPath","pushDrawPath","activeElement","tagName","ex","localStorage","removeItem","alert","handleError","App","combinedReducer","combineReducers","store","createStore","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.9ead184d.chunk.js","sourcesContent":["// settings\nexport const CHANGE_CURSORSIZE = 'SETTINGS/CHANGE_CURSORSIZE'\nexport const CHANGE_FOG_SETTINGS = 'SETTINGS/CHANGE_FOG_SETTINGS'\nexport const CHANGE_DRAW_SETTINGS = 'SETTINGS/CHANGE_DRAW_SETTINGS'\nexport const CHANGE_TOOL = 'SETTINGS/CHANGE_TOOL'\nexport const CHANGE_USERNAME = 'SETTINGS/CHANGE_USERNAME'\nexport const TOGGLE_MOUSESHARING = 'SETTINGS/TOGGLE_MOUSESHARING'\n\n// game\nexport const OVERWRITE_GAME = 'GAME/OVERWRITE_GAME'\nexport const LOAD_MAP = 'GAME/LOAD_MAP'\nexport const INCREMENT_GEN = 'GAME/INCREMENT_GEN'\nexport const SET_FOG_ENABLED = 'GAME/SET_FOG_ENABLED'\nexport const SET_ISFOGLOADED = 'GAME/SET_ISFOGLOADED'\nexport const SET_ISFIRSTLOADDONE = 'GAME/SET_ISFIRSTLOADDONE'\nexport const UPDATE_MAPS = 'GAME/UPDATE_MAPS'\nexport const ADD_MAP = 'GAME/ADD_MAP'\nexport const DELETE_MAP = 'GAME/DELETE_APP'\nexport const UPDATE_TOKENS = 'GAME/UPDATE_TOKENS'\nexport const ADD_TOKEN = 'GAME/ADD_TOKEN'\nexport const DELETE_TOKEN = 'GAME/DELETE_TOKEN'\nexport const COPY_TOKEN = 'GAME/COPY_TOKEN'\nexport const UPDATE_TOKEN_VALUE = 'GAME/UPDATE_TOKEN_VALUE'\nexport const TOGGLE_TOKEN_VALUE = 'GAME/TOGGLE_TOKEN_VALUE'\nexport const RESET_FOG = 'GAME/RESET_FOG'\nexport const RESET_DRAW = 'GAME/RESET_DRAW'\n\n// metadata\nexport const SET_GAMESETTINGS = 'METADATA/SET_GAMESETTINGS'\nexport const SET_ISHOST = 'METADATA/SET_ISHOST'\nexport const SET_ROOM = 'METADATA/ROOM'\nexport const SET_CURSORS = 'METADATA/SET_CURSORS'\nexport const SET_LAST_COORDINATES = 'METADATA/SET_LAST_COORDINATES'\nexport const SET_DOWN_COORDINATES = 'METADATA/SET_DOWN_COORDINATES'\n\n// controlpanel\n//TODO: Add control panel actions\n","import { \n    CHANGE_CURSORSIZE,\n    CHANGE_FOG_SETTINGS,\n    CHANGE_DRAW_SETTINGS, \n    CHANGE_TOOL,\n    CHANGE_USERNAME,\n    TOGGLE_MOUSESHARING \n} from '../redux/constants'\n\nconst initialSettingsState = () => {\n    const params = new URLSearchParams(window.location.href.replace(/.*\\?/, ''))\n    return {\n        cursorSize: 50,\n        fogOpacity: 0.5,\n        fogRadius: 75,\n        drawColor: 'white',\n        drawSize: 8,\n        tool: 'move',\n        subtool: undefined,\n        username: params.get('host') ? 'DM' : 'PC',\n        shareMouse: true,\n    }\n}\n\nconst settingsReducer = (state = initialSettingsState(), action) => {\n    switch (action.type) {\n        case CHANGE_CURSORSIZE:\n            return {\n                ...state,\n                cursorSize: action.cursorSize,\n            }\n        case CHANGE_FOG_SETTINGS:\n            return {\n                ...state,\n                fogOpacity: action.fogOpacity,\n                fogRadius: action.fogRadius,\n            }\n        case CHANGE_DRAW_SETTINGS:\n            return {\n                ...state,\n                drawColor: action.drawColor,\n                drawSize: action.drawSize,\n            }\n        case CHANGE_TOOL:\n            return {\n                ...state,\n                tool: action.tool,\n                subtool: action.subtool,\n            }\n        case CHANGE_USERNAME:\n            return {\n                ...state,\n                username: action.username,\n            }\n        case TOGGLE_MOUSESHARING:\n            return {\n                ...state,\n                shareMouse: !state.shareMouse,\n            }\n        default:\n            return state\n    }\n}\n\n//#region Action Creators\nexport const setCursorSize = (newCursorSize) => {\n    return {\n        type: CHANGE_CURSORSIZE,\n        cursorSize: parseInt(newCursorSize),\n    }\n}\n\nexport const setFogToolSettings = (newFogOpacity, newFogRadius) => {\n    return {\n        type: CHANGE_FOG_SETTINGS,\n        fogOpacity: newFogOpacity,\n        fogRadius: parseInt(newFogRadius),\n    }\n}\n\nexport const setDrawToolSettings = (newDrawColor, newDrawSize) => {\n    return {\n        type: CHANGE_DRAW_SETTINGS,\n        drawColor: newDrawColor,\n        drawSize: parseInt(newDrawSize),\n    }\n}\n\nexport const setToolSettings = (newTool, newSubtool) => {\n    return {\n        type: CHANGE_TOOL,\n        tool: newTool,\n        subtool: newSubtool,\n    }\n}\n\nexport const setUsername = (newUsername) => {\n    return {\n        type: CHANGE_USERNAME,\n        username: newUsername,\n    }\n}\n\nexport const toggleMousesharing = () => {\n    return {\n        type: TOGGLE_MOUSESHARING,\n    }\n}\n//#endregion Action Creators\n\nexport default settingsReducer\n","import { \n    SET_GAMESETTINGS,\n    /* SET_ISHOST,\n    SET_ROOM,*/\n    SET_CURSORS,\n    SET_LAST_COORDINATES,\n    SET_DOWN_COORDINATES \n} from '../redux/constants'\n\nconst initialMetadataState = {\n    isHost: undefined,\n    room: undefined,\n    cursors: [],\n    lastX: undefined,\n    lastY: undefined,\n    downX: undefined,\n    downY: undefined,\n}\n\nconst metadataReducer = (state = initialMetadataState, action) => {\n    switch (action.type) {\n        case SET_GAMESETTINGS:\n            return {\n                ...state,\n                isHost: action.isHost,\n                room: action.room,\n            }\n        //TODO: Delete if unused\n        /*\n        case SET_ISHOST:\n            return {\n                ...state,\n                isHost: action.isHost,\n            }\n        case SET_ROOM:\n            return {\n                ...state,\n                room: action.room,\n            }\n        */\n       case SET_CURSORS:\n           return {\n               ...state,\n               cursors: action.cursors,\n           }\n        case SET_LAST_COORDINATES:\n            return {\n                ...state,\n                lastX: action.lastX,\n                lastY: action.lastY,\n            }\n        case SET_DOWN_COORDINATES:\n            return {\n                ...state,\n                downX: action.downX,\n                downY: action.downY,\n            }\n        default:\n            return state\n    }\n}\n\n//#region Action Creators\nexport const setGameSettings = (newIsHost, newRoom) => {\n    return {\n        type: SET_GAMESETTINGS,\n        isHost: newIsHost,\n        room: newRoom,\n    }\n}\n\n//TODO: Delete if unused\n/*\nexport const setIsHost = (newIsHost) => {\n    return {\n        type: SET_ISHOST,\n        isHost: newIsHost,\n    }\n}\n\nexport const setRoom = (newRoom) => {\n    return {\n        type: SET_ROOM,\n        room: newRoom,\n    }\n}\n*/\n\nexport const setCursors = (newCursors) => {\n    return {\n        type: SET_CURSORS,\n        cursors: newCursors,\n    }\n}\n\nexport const setLastCoordinates = (newLastX, newLastY) => {\n    return {\n        type: SET_LAST_COORDINATES,\n        lastX: newLastX,\n        lastY: newLastY,\n    }\n}\n\nexport const setDownCoordinates = (newDownX, newDownY) => {\n    return {\n        type: SET_DOWN_COORDINATES,\n        downX: newDownX,\n        downY: newDownY,\n    }\n}\n//#endregion Action Creators\n\nexport default metadataReducer\n","const guid = () => {\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\tconst r = (window.crypto.getRandomValues(new Uint32Array(1))[0] * Math.pow(2,-32) * 16) | 0\n\t\tconst v = c === 'x' ? r : (r & 0x3 | 0x8) /* eslint-disable-line no-mixed-operators */\n\t\treturn v.toString(16)\n\t})\n}\nexport default guid\n","import {\n    OVERWRITE_GAME,\n    LOAD_MAP, \n    INCREMENT_GEN, \n    SET_FOG_ENABLED,\n    SET_ISFIRSTLOADDONE, \n    SET_ISFOGLOADED, \n    UPDATE_MAPS, \n    ADD_MAP,\n    DELETE_MAP,\n    UPDATE_TOKENS,\n    ADD_TOKEN,\n    DELETE_TOKEN,\n    COPY_TOKEN,\n    UPDATE_TOKEN_VALUE,\n    TOGGLE_TOKEN_VALUE,\n    RESET_FOG,\n    RESET_DRAW\n} from '../redux/constants'\nimport guid from '../controllers/guid.js'\n\nconst initialGameState = {\n    mapId: undefined,\n    gen: 0,\n    width: window.innerWidth,\n    height: window.innerHeight,\n    fogEnabled: false,\n    isFogLoaded: false,\n    isFirstLoadDone: false, /* Ensure we don't overwrite localStorage before load is done */\n    maps: [],\n    tokens: [],\n}\n\nconst gameReducer = (state = initialGameState, action) => {\n    const maps = JSON.parse(JSON.stringify(state.maps))\n    const tokens = JSON.parse(JSON.stringify(state.tokens))\n    switch (action.type) {\n        case OVERWRITE_GAME:\n            return {\n                ...state,\n                ...action.game,\n            }\n        case LOAD_MAP:\n            return {\n                ...state,\n                mapId: parseInt(action.mapId),\n            }\n        case INCREMENT_GEN:\n            return {\n                ...state,\n                gen: state.gen + 1,\n            }\n        case SET_FOG_ENABLED:\n            return {\n                ...state,\n                fogEnabled: action.fogEnabled,\n            }\n        case SET_ISFOGLOADED:\n            return {\n                ...state,\n                isFogLoaded: action.isFogLoaded,\n            }\n        case SET_ISFIRSTLOADDONE:\n            return {\n                ...state,\n                isFirstLoadDone: action.isFirstLoadDone,\n            }\n        case UPDATE_MAPS:\n            return {\n                ...state,\n                maps: action.maps,\n                mapId: !isNaN(state.mapId) ? state.mapId : undefined,\n            }\n        case ADD_MAP:\n            const newMapId = state.maps.length\n            const mapsWithNewMap = maps.concat({\n                ...action.map,\n                $id: newMapId,\n            })\n            return {\n                ...state,\n                maps: mapsWithNewMap,\n                mapId: !isNaN(state.mapId) ? state.mapId : newMapId,\n                isFirstLoadDone: true,\n                isFogLoaded: true,\n            }\n        case DELETE_MAP:\n\t\t\tconst newMaps = maps.filter((map) => map.$id !== parseInt(action.mapId))\n            return {\n                ...state,\n                maps: newMaps,\n                mapId: parseInt(action.mapId) === state.mapId ? undefined : state.mapId,\n            }\n        case UPDATE_TOKENS:\n            return {\n                ...state,\n                tokens: action.tokens,\n            }\n        case ADD_TOKEN:\n            return {\n                ...state,\n                tokens: state.tokens.concat(action.token)\n            }\n        case DELETE_TOKEN:\n            const newTokens = tokens.filter((token) => token.guid !== action.tokenGuid)\n            return {\n                ...state,\n                tokens: newTokens,\n            }\n        case COPY_TOKEN:\n            const tokenCopy = state.tokens.filter((token) => token.guid === action.tokenGuid)\n            tokenCopy.guid = guid()\n            return {\n                ...state,\n                tokens: state.tokens.concat(tokenCopy)\n            }\n        case UPDATE_TOKEN_VALUE:\n            const tokensCopy = state.tokens.map((token) => {\n                return token.guid !== action.tokenGuid ? token : {\n                    ...token,\n                    [action.key]: action.value\n                }\n            })\n            return {\n                ...state,\n                tokens: tokensCopy,\n            }\n        case TOGGLE_TOKEN_VALUE:\n            const tokensCopy2 = state.tokens.map((token) => {\n                return token.guid !== action.tokenGuid ? token : {\n                    ...token,\n                    [action.key]: !token[action.key]\n                }\n            })\n            return {\n                ...state,\n                tokens: tokensCopy2,\n            }\n        case RESET_FOG:\n\t\t\tconst fogResetMaps = state.maps.map((map) => {\n                return map.$id === state.mapId ? {\n                        ...map,\n                        fogPaths: [],\n                    } \n                    : map\n                })\n            return {\n                ...state,\n                maps: fogResetMaps,\n            }\n        case RESET_DRAW:\n            const drawResetMaps = state.maps.map((map) => {\n                return map.$id === state.mapId ? {\n                        ...map,\n                        drawPaths: [],\n                    } \n                    : map\n                })\n            return {\n                ...state,\n                maps: drawResetMaps,\n            }\n        default:\n            return state\n    }\n}\n\n//#region Action Creators\nexport const overwriteGame = (newGame) => {\n    return {\n        type: OVERWRITE_GAME,\n        game: newGame,\n    }\n}\n\nexport const loadMap = (newMapId) => {\n    return {\n        type: LOAD_MAP,\n        mapId: parseInt(newMapId),\n    }\n}\n\nexport const incrementGen = () => {\n    return {\n        type: INCREMENT_GEN,\n    }\n}\n\nexport const setFogEnabled = (newFogEnabled) => {\n    return {\n        type: SET_FOG_ENABLED,\n        fogEnabled: newFogEnabled,\n    }\n}\n\nexport const setIsFogLoaded = (newIsFogLoaded) => {\n    return {\n        type: SET_ISFOGLOADED,\n        isFogLoaded: newIsFogLoaded,\n    }\n}\n\nexport const setIsFirstLoadDone = (newIsFirstLoadDone) => {\n    return {\n        type: SET_ISFIRSTLOADDONE,\n        isFirstLoadDone: newIsFirstLoadDone,\n    }\n}\n\nexport const updateMaps = (newMaps) => {\n    return {\n        type: UPDATE_MAPS,\n        maps: newMaps,\n    }\n}\n\nexport const addMap = (mapName, width, height) => {\n    const newMap = {\n        name: mapName,\n        $id: 0,\n        imageUrl: '',\n        x: 0,\n        y: 0,\n        width: width,\n        height: height,\n        drawPaths: [],\n        fogPaths: [],\n    }\n\n    return {\n        type: ADD_MAP,\n        map: newMap,\n    }\n}\n\nexport const deleteMap = (mapIdToDelete) => {\n    return {\n        type: DELETE_MAP,\n        mapId: mapIdToDelete,\n    }\n}\n\nexport const updateTokens = (newTokens) => {\n    return {\n        type: UPDATE_TOKENS,\n        tokens: newTokens,\n    }\n}\n\nexport const addToken = (tokenName, tokenUrl, mapId) => {\n    const newToken = {\n        guid: guid(),\n        name: tokenName,\n        url: tokenUrl,\n        mapId: mapId,\n        $selected: undefined,\n        $x0: 0,\n        $y0: 0,\n        x: 0,\n        y: 0,\n        ko: undefined,\n        pc: undefined,\n        w: 0,\n        h: 0,\n    }\n\n    return {\n        type: ADD_TOKEN,\n        token: newToken,\n    }\n}\n\nexport const deleteToken = (tokenGuidToDelete) => {\n    return {\n        type: DELETE_TOKEN,\n        tokenGuid: tokenGuidToDelete,\n    }\n}\n\nexport const copyToken = (tokenGuidToCopy) => {\n    return {\n        type: COPY_TOKEN,\n        tokenGuid: tokenGuidToCopy,\n    }\n}\n\nexport const updateTokenValue = (tokenGuidToUpdate, key, value) => {\n    return {\n        type: UPDATE_TOKEN_VALUE,\n        tokenGuid: tokenGuidToUpdate,\n        key: key,\n        value: value,\n    }\n}\n\nexport const toggleTokenValue = (tokenGuidToUpdate, key) => {\n    return {\n        type: TOGGLE_TOKEN_VALUE,\n        tokenGuid: tokenGuidToUpdate,\n        key: key,\n    }\n}\n\nexport const resetFog = () => {\n    return {\n        type: RESET_FOG,\n    }\n}\n\nexport const resetDraw = () => {\n    return {\n        type: RESET_DRAW,\n    }\n}\n//#endregion Action Creators\n\nexport default gameReducer\n","import { useContext } from \"react\";\nimport { WebSocketContext } from \"../contexts/WebSocketProvider\";\n\nexport const useWebSocket = () => {\n    const webSocket = useContext(WebSocketContext)\n    return webSocket\n}\n\nconst sendData = (webSocket, data) => {\n    if (webSocket && webSocket.readyState === WebSocket.OPEN)\n        webSocket.send(JSON.stringify(data))\n    else\n        console.error('no websocket')\n}\n\nexport const pushCursor = (webSocket, wsSettings, x, y, username) => {\n    sendData(webSocket, {\n        type: 'pushCursor',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        x: x,\n        y: y,\n    })\n}\n\nexport const pushDrawPath = (webSocket, wsSettings, newDrawPath) => {\n    sendData(webSocket, {\n        type: 'pushDrawPath',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        drawPath: newDrawPath,\n    })\n}\n\nexport const pushDrawReset = (webSocket, wsSettings) => {\n    sendData(webSocket, {\n        type: 'pushDrawReset',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n    })\n}\n\nexport const pushFogPath = (webSocket, wsSettings, newFogPath) => {\n    sendData(webSocket, {\n        type: 'pushFogPath',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        fogPath: newFogPath,\n    })\n}\n\nexport const pushFogReset = (webSocket, wsSettings) => {\n    sendData(webSocket, {\n        type: 'pushFogReset',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n    })\n}\n\nexport const pushMapState = (webSocket, wsSettings, maps, mapId) => {\n    sendData(webSocket, {\n        type: 'pushMapState',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        maps: maps,\n        mapId: mapId,\n    })\n}\n\nexport const pushMapId = (webSocket, wsSettings, mapId) => {\n    sendData(webSocket, {\n        type: 'pushMapId',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        mapId: mapId,\n    })\n}\n\nexport const pushCreateMap = (webSocket, wsSettings, newMapName, newWidth, newHeight) => {\n    sendData(webSocket, {\n        type: 'pushCreateMap',\n        from: wsSettings.guid,\n        mapName: newMapName,\n        width: newWidth,\n        height: newHeight,\n    })\n}\n\nexport const pushFogEnabled = (webSocket, wsSettings, newFogEnabled) => {\n    sendData(webSocket, {\n        type: 'pushFogEnabled',\n        from: wsSettings.guid,\n        fogEnabled: newFogEnabled,\n    })\n}\n\nexport const pushGameRefresh = (webSocket, wsSettings, game, additionalAttributes) => {\n    sendData(webSocket, {\n        type: 'pushGameRefresh',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n        game: game,\n        ...additionalAttributes,\n    })\n}\n\nexport const pushSingleToken = (webSocket, wsSettings, token) => {\n    //TODO: pushSingleToken\n    /*\n    const tokenCopy = Object.assign({}, token)\n    this.scrubObject(tokenCopy)\n    const data = {type: 'pushSingleToken', i: index, a: tokenCopy}\n    this.send(data)\n    */\n}\n\nexport const pushTokens = (webSocket, wsSettings, tokens) => {\n    //TODO: pushTokens\n    /*\n    if (!tokens)\n        return\n    const tokensCopy = JSON.parse(JSON.stringify(tokens))\n    const data = { type: 'pushTokens', tokens: tokensCopy }\n    data.tokens.forEach(token => this.scrubObject(token))\n    this.send(data)\n    */\n}\n\nexport const requestRefresh = (webSocket, wsSettings) => {\n    sendData(webSocket, {\n        type: 'requestRefresh',\n        from: wsSettings.guid,\n        username: wsSettings.username,\n    })\n}\n","import React, { useEffect, useState, createContext } from 'react'\nimport { connect } from 'react-redux'\nimport { requestRefresh } from '../hooks/useSocket.js'\nimport guid from '../controllers/guid.js'\nrequire('dotenv').config()\n\nconst DEBUG_MODE = process.env.NODE_ENV === 'production' ? false : true\nconst SOCKET_RECONNECTION_TIMEOUT = 2500\nconst SOCKET_SERVER_PORT = process.env.PORT || process.env.REACT_APP_PORT || 8000\n\nconst generateWebSocketUrl = (room, guid) => {\n    let host = window.location.host.replace(/:\\d+$/, '')\n\tconst protocol = /https/.test(window.location.protocol) ? 'wss' : 'ws'\n\n    return DEBUG_MODE\n        ? `${protocol}://${host}:${SOCKET_SERVER_PORT}/${room}?guid=${guid}`\n        : `${protocol}://${host}/${room}?guid=${guid}`\n}\n\nconst createWebSocket = (room, guid) => {\n\tif (room) {\n\t\tconst webSocketUrl = generateWebSocketUrl(room, guid)\n\t\treturn new WebSocket(webSocketUrl)\n\t} else {\n\t\treturn undefined\n\t}\n}\n\nexport const WebSocketContext = createContext(createWebSocket('',''))\n\nconst WebSocketProvider = ({ children, metadata }) => {\n    const [wsSettings, setWsSettings] = useState({\n        guid: guid(),\n        username: '',\n    })\n    const [ws, setWs] = useState(createWebSocket(metadata.room, wsSettings.guid))\n\n\tuseEffect(() => {\n\t\tsetWs(createWebSocket(metadata.room, wsSettings.guid))\n\t}, [metadata.room, wsSettings.guid])\n\n    useEffect(() => {\n        const onClose = () => {\n            setTimeout(() => {\n\t\t\t\tconsole.log('Socket Timeout, recreating WebSocket')\n                setWs(createWebSocket(metadata.room, wsSettings.guid))\n            }, SOCKET_RECONNECTION_TIMEOUT)\n        }\n\n        const onOpen = () => {\n            if (!metadata.isHost) {\n                requestRefresh(ws, wsSettings)\n            }\n        }\n\n\t\tconst onError = (err) => {\n\t\t\tconsole.error('WebSocket could not be created. Error: ',err)\n\t\t}\n\n\t\tif (ws) {\n\t\t\tws.addEventListener('close', onClose)\n\t\t\tws.addEventListener('open', onOpen)\n\t\t\tws.addEventListener('error', onError)\n\t\t}\n\n        return () => {\n\t\t\tif (ws) {\n\t\t\t\tws.removeEventListener('close', onClose)\n\t\t\t\tws.removeEventListener('open', onOpen)\n\t\t\t\tws.removeEventListener('error', onError)\n\t\t\t}\n        }\n    }, [ ws, setWs, wsSettings, metadata ])\n\n    return (\n        <WebSocketContext.Provider value={ [ws, wsSettings, setWsSettings] }>{ children }</WebSocketContext.Provider>\n    )\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tmetadata: state.metadata,\n\t}\n}\n\nexport default connect(mapStateToProps, undefined)(WebSocketProvider)\n","const drawImage = (url, which, map, context, resizeCanvases) => {\n\t// Handle 'whiteboard' (no bg img)\n\tif (!url || url.trim().length === 0) {\n\t\tif (resizeCanvases) {\n\t\t\tresizeCanvases()\n\t\t} // Clear canvas\n\t\treturn Promise.resolve(map.width, map.height)\n\t}\n\n\t//Handle ordinary image\n\treturn new Promise((resolve, reject) => {\n\t\tconst ctx = context\n\t\tconst img = new Image()\n\t\timg.onload = () => {\n\t\t\tlet w = map.width\n\t\t\tlet h = map.height\n\t\t\tif (!w && !h) {\n\t\t\t\tw = img.width\n\t\t\t\th = img.height\n\t\t\t} else if (!w)\n\t\t\t\tw = h * img.width / img.height\n\t\t\telse if (!h)\n\t\t\t\th = w * img.height / img.width\n\t\t\tconst promise = resizeCanvases ? resizeCanvases(w, h) : Promise.resolve()\n\t\t\tpromise.then(() => {\n\t\t\t\tctx.drawImage(img, map.x || 0, map.y || 0, w, h)\n\t\t\t\tresolve(w, h)\n\t\t\t})\n\t\t}\n\t\timg.onerror = (err) => {\n\t\t\tconsole.error(`Unable to draw image.`, img.src)\n\t\t\treject(`Unable to draw ${which}Url`)\n\t\t}\n\t\timg.src = url\n\t})\n}\n\nexport default drawImage\n","import { useRef, useEffect } from 'react'\n\nconst useCanvas = (draw, gameState, options={}) => {\n\tconst canvasRef = useRef(null)\n\n\tuseEffect(() => {\n\t\tconst canvas = canvasRef.current\n\t\tconst context = canvas.getContext(options.context || '2d')\n\t\t\n\t\tdraw(context)\n\t}, [draw]) // eslint-disable-line react-hooks/exhaustive-deps\n\n\treturn canvasRef\n}\nexport default useCanvas\n","import React from 'react'\nimport useCanvas from '../hooks/useCanvas.js'\n\nconst Canvas = ({ id, draw, options, ...rest }) => {\n\tconst canvasRef = useCanvas(draw)\n\t\n\treturn (\n\t\t<canvas id={ id } ref={ canvasRef } { ...rest } />\n\t)\n}\n\nexport default Canvas\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { updateTokens } from '../reducers/gameReducer'\nimport drawImage from '../controllers/drawImage.js'\nimport Canvas from './Canvas.js'\n\n\nconst Background = ({ game, updateTokens }) => {\n\tconst map = game.maps ? game.maps[game.mapId] : undefined\n\n\tconst draw = (ctx) => {\n\t\tif (!map) {\n\t\t\treturn\n\t\t}\n\t\tdrawImage(map.imageUrl, map.name, map, ctx, null)\n\t}\n\n\tconst handleOnClick = (e) => {\n\t\t//TODO: Handle onClick of Maps\n\t\t/*\n\t\tsetControlPanelState({\n\t\t\t...controlPanelState,\n\t\t\ttoggleOnMaps: false,\n\t\t\ttoggleOnTokens: false,\n\t\t}, () => updateTokens(token => token.$selected = false))\n\t\t*/\n\t}\n\n\treturn (\n\t\t<Canvas \n\t\t\tid='background' \n\t\t\tonClick={ handleOnClick } \n\t\t\twidth={ map ? map.width : 0 } \n\t\t\theight={ map ? map.height : 0 } \n\t\t\tdraw={ draw } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tupdateTokens,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Background)\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport Canvas from './Canvas.js'\n\nconst Drawing = ({ game }) => {\n\tconst width = game.width\n\tconst height = game.height\n\n\tconst getMap = () => {\n\t\tif (game.maps.length === 0)\n\t\t\treturn undefined\n\t\tconst currMap = game.maps.filter((map) => parseInt(map.$id) === parseInt(game.mapId))\n\t\treturn currMap.length > 0 ? currMap[0] : game.maps[0]\n\t}\n\tconst map = getMap()\n\n\tconst renderDrawingLayer = (ctx) => {\n\t\tif (!map) {\n\t\t\treturn\n\t\t}\n\t\tif (!ctx)\n\t\t\treturn\n\t\t\n\t\tctx.beginPath()\n\t\tctx.clearRect(0, 0, width, height)\n\t\tfor(let pathId = 0; pathId < map.drawPaths.length; pathId++) {\n\t\t\tconst currPath = map.drawPaths[pathId]\n\t\t\tconst tool = currPath.length > 0 ? currPath[0].tool : ''\n\t\t\tswitch (tool) {\n\t\t\t\tcase 'draw': \n\t\t\t\t\tdraw(ctx, currPath)\n\t\t\t\t\tbreak\n\t\t\t\tcase 'erease':\n\t\t\t\t\terease(ctx, currPath)\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t\tctx.stroke()\n\t\t}\n\t}\n\n\tconst draw = (ctx, currPath) => {\n\t\tctx.globalCompositeOperation = 'source-over'\n\t\tctx.beginPath()\n\t\tfor (let pointId = 0; pointId < currPath.length; pointId++) {\n\t\t\tctx.lineCap = 'round'\n\t\t\tctx.fillStyle = currPath[pointId].drawColor\n\t\t\tctx.lineWidth = currPath[pointId].drawSize\n\t\t\tctx.strokeStyle = currPath[pointId].drawColor\n\t\t\tif (pointId === 0) {\n\t\t\t\tctx.moveTo(currPath[pointId].x, currPath[pointId].y)\n\t\t\t} else {\n\t\t\t\tctx.lineTo(currPath[pointId].x, currPath[pointId].y)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst erease = (ctx, currPath) => {\n\t\tctx.globalCompositeOperation = 'destination-out'\n\t\tctx.beginPath()\n\t\tfor (let pointId = 0; pointId < currPath.length; pointId++) {\n\t\t\tctx.lineCap = 'round'\n\t\t\tctx.lineWidth = currPath[pointId].drawSize\n\t\t\tif (pointId === 0) {\n\t\t\t\tctx.moveTo(currPath[pointId].x, currPath[pointId].y)\n\t\t\t} else {\n\t\t\t\tctx.lineTo(currPath[pointId].x, currPath[pointId].y)\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn (\n\t\t<Canvas \n\t\t\tid='drawing' \n\t\t\tclassName='passthrough' \n\t\t\twidth={ width } \n\t\t\theight={ height } \n\t\t\tdraw={ renderDrawingLayer } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nexport default connect(mapStateToProps, undefined)(Drawing)\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport Canvas from './Canvas.js'\n\nconst Fog = ({ game, metadata, settings }) => {\n\tconst fogOpacity = metadata.isHost ? settings.fogOpacity : 1\n\tconst width = game.width\n\tconst height = game.height\n\n\tconst getMap = () => {\n\t\tif (game.maps.length === 0)\n\t\t\treturn undefined\n\t\tconst currMap = game.maps.filter((map) => parseInt(map.$id) === parseInt(game.mapId))\n\t\treturn currMap.length > 0 ? currMap[0] : game.maps[0]\n\t}\n\tconst map = getMap()\n\n\tconst renderFogLayer = (ctx) => {\n\t\tif (!map) {\n\t\t\treturn\n\t\t}\n\t\tif (!ctx)\n\t\t\treturn\n\t\t\n\t\tctx.beginPath()\n\t\tctx.globalCompositeOperation = 'destination-over'\n\t\tctx.fillStyle = 'black'\n\t\tctx.fillRect(0, 0, width, height)\n\t\tfor(let pathId = 0; pathId < map.fogPaths.length; pathId++) {\n\t\t\tconst currPath = map.fogPaths[pathId]\n\t\t\tereaseFog(ctx, currPath)\n\t\t\tctx.stroke()\n\t\t}\n\t}\n\n\tconst ereaseFog = (ctx, currPath) => {\n\t\tctx.beginPath()\n\t\tctx.globalCompositeOperation = 'destination-out'\n\t\tlet gradient\n\t\tfor (let pointId = 0; pointId < currPath.length; pointId++) {\n\t\t\tgradient = ctx.createRadialGradient(currPath[pointId].x, currPath[pointId].y, currPath[pointId].r2 || 1, currPath[pointId].x, currPath[pointId].y, currPath[pointId].r*0.75)\n\t\t\tgradient.addColorStop(0, 'rgba(0,0,0,255)')\n\t\t\tgradient.addColorStop(1, 'rgba(0,0,0,0)')\n\t\t\tctx.fillStyle = gradient\n\t\t\tctx.fillRect(currPath[pointId].x-currPath[pointId].r, currPath[pointId].y-currPath[pointId].r, currPath[pointId].x+currPath[pointId].r, currPath[pointId].y+currPath[pointId].r)\n\t\t}\n\t}\n\n\treturn (\n\t\tgame.fogEnabled ?\n\t\t\t<Canvas \n\t\t\t\tid='fog' \n\t\t\t\tclassName='passthrough' \n\t\t\t\tstyle={{ opacity: fogOpacity }} \n\t\t\t\twidth={ width } \n\t\t\t\theight={ height } \n\t\t\t\tdraw={ renderFogLayer } />\n\t\t\t: null\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t\tsettings: state.settings,\n\t\tmetadata: state.metadata,\n\t}\n}\n\nexport default connect(mapStateToProps, undefined)(Fog)\n","import React from 'react';\nimport { connect } from 'react-redux'\n\nconst Overlay = ({ game, overlayRef }) => {\n\tconst maps = game.maps\n\tconst map = maps[game.mapId] || undefined\n\tconst width = map ? map.width : game.width\n\tconst height = map ? map.height : game.height\n\tconst canvasRef = overlayRef\n\n\treturn (\n\t\t<canvas \n\t\t\tid='overlay' \n\t\t\tref={ canvasRef } \n\t\t\twidth={ width } \n\t\t\theight={ height } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nexport default connect(mapStateToProps, undefined)(Overlay)\n","const TokenView = ({ divStyle, token, classes, imgStyle, onMouseUp, onMouseDown }) => {\n\treturn (\n\t\t<div style={ divStyle } title={ token.name } className={ classes.join(' ') } onMouseDown={ (e) => onMouseDown(e) }>\n\t\t\t<img src={ token.url } alt={ token.name ||'' } style={ imgStyle } />\n\t\t</div>\n\t)\n}\n\nexport default TokenView\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport TokenView from '../views/TokenView.js'\n\nconst Token = ({ token, isHost, game, settings }) => {\n\tconst isMoveTool = () => {\n\t\treturn settings.tool === 'move'\n\t}\n\n\tconst onMouseDown = (e) => {\n\t\tif (!isMoveTool())\n\t\t\treturn\n\t\t//TODO: Fix multi token selection\n\t\t/*\n\t\tif (!token.$selected)\n\t\t\tselectGameToken(token, true, e.metaKey)\n\t\t*/\n\t}\n\n\tif (!token.url || !token.url.trim())\n\t\treturn null\n\t\n\tconst classes = [\n\t\t'token',\n\t\ttoken.ko && 'dead',\n\t\ttoken.pc ? 'pc' : 'npc',\n\t\ttoken.$selected && 'selected',\n\t\tisHost && !token.pc && 'grabbable',\n\t]\n\tconst divStyle = {\n\t\tleft: token.x || 0,\n\t\ttop: token.y || 0,\n\t}\n\tconst imgStyle = {\n\t\twidth: token.width || undefined,\n\t\theight: token.height || undefined,\n\t}\n\tconst showToken = ((token.mapId === undefined) || (game.mapId === token.mapId))\n\n\treturn (\n\t\tshowToken ?\n\t\t\t<TokenView \n\t\t\t\tdivStyle={ divStyle } \n\t\t\t\ttoken={ token } \n\t\t\t\tclasses={ classes } \n\t\t\t\timgStyle={ imgStyle } \n\t\t\t\tonMouseDown={ onMouseDown }\n\t\t\t/>\n\t\t: null\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t\tsettings: state.settings,\n\t}\n}\n\nconst mapDispatchToProps = {\n\t\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Token)\n","const Cursor = ({ cursor, size, name }) => {\n\tconst divStyle = {\n\t\ttop: cursor.y,\n\t\tleft: cursor.x,\n\t}\n\tconst imgStyle = {\n\t\tfontSize: size || undefined,\n\t}\n\n\treturn (\n\t\t<div style={ divStyle } className='cursor' >\n\t\t\t<span role='img' aria-label='pointer' style={ imgStyle }>&#x1f5e1;</span>\n\t\t\t{ cursor.u || name }\n\t\t</div>\n\t)\n}\n\nexport default Cursor\n","function Button({ title, value, onClick, isSelected, style, disabled }) {\n\treturn (\n\t\t<button title={ title } onClick={ onClick } className={ isSelected ? 'selected' : null } style={ style } disabled={ disabled }>\n\t\t\t<span role='img' aria-label={ title }>{ value }</span>\n\t\t</button>\n\t)\n}\n\nexport default Button\n","import Button from '../views/Button.js'\n\nfunction ToggleButton({ controlPanelState, setControlPanelState, title, value }) {\n\tconst toggleKey = `toggleOn${title}`\n\tconst onClick = () => {\n\t\tsetControlPanelState({\n\t\t\t...controlPanelState,\n\t\t\t[toggleKey]: !controlPanelState[toggleKey],\n\t\t})\n\t}\n\tconst isSelected = controlPanelState[toggleKey]\n\treturn (\n\t\t<Button title={ title } value={ value } onClick={ onClick } isSelected={ isSelected } />\n\t)\n}\n\nexport default ToggleButton\n","import Button from './Button.js'\n\nconst ToolControlsView = ({ tool, subtool, drawColor, setDrawColor, drawSize, setDrawSize, fogOpacity, setFogOpacity, fogRadius, setFogRadius, setSubtool, resetFog, resetDrawing }) => {\n\tswitch (tool) {\n\t\tcase 'draw':\n\t\t\treturn (\n\t\t\t\t<span>\n\t\t\t\t\t<Button title='eraser' value='&#x1f9fd;' onClick={ () => setSubtool('eraser') } isSelected={ subtool === 'eraser' } />\n\t\t\t\t\t<Button title='pencil' value='&#x1f58d;' onClick={ () => setSubtool('pencil') } isSelected={ subtool === 'pencil' } />\n\t\t\t\t\t<input size='3' title='draw size' value={ drawSize } onChange={ (e) => setDrawSize(e.target.value) } type='number' step='3' min='1' />\n\t\t\t\t\t<input size='3' title='draw color' value={ drawColor } onChange={ (e) => setDrawColor(e.target.value) } />\n\t\t\t\t\t<Button style={{ backgroundColor: drawColor }} value='&#x1f58c;' disabled />\n\t\t\t\t\t<Button title='reset drawing' onClick={ resetDrawing } value='&#x1f300;' />\n\t\t\t\t</span>\n\t\t\t)\n\t\tcase 'move':\n\t\t\treturn null\n\t\tcase 'fog':\n\t\t\treturn (\n\t\t\t\t<span>\n\t\t\t\t\t<Button title='reset fog' onClick={ resetFog } value='&#x1f300;' />\n\t\t\t\t\t<input size='3' title='fog radius' value={ fogRadius } onChange={ (e) => setFogRadius(e.target.value) } type='number' step='5' min='1' />\n\t\t\t\t\t<input size='3' title='fog opacity' step='0.05' min='0' max='1' value={ fogOpacity } onChange={ (e) => setFogOpacity(e.target.value) } type='number' />\n\t\t\t\t</span>\n\t\t\t)\n\t\tdefault:\n\t\t\treturn null\n\t}\n}\n\nexport default ToolControlsView\n","import { connect } from 'react-redux'\nimport { setToolSettings, setDrawToolSettings, setFogToolSettings } from '../reducers/settingsReducer.js'\nimport { resetFog, resetDraw } from '../reducers/gameReducer.js'\nimport ToolControlsView from \"../views/ToolControlsView.js\"\n\nconst ToolControls = ({ settings, setToolSettings, setDrawToolSettings, setFogToolSettings, resetFog, resetDraw }) => {\n\tconst setSubtool = (subtool) => {\n\t\tsetToolSettings(settings.tool, subtool)\n\t}\n\n\tconst setDrawColor = (value) => {\n\t\tsetDrawToolSettings(value, settings.drawSize)\n\t}\n\n\tconst setDrawSize = (value) => {\n\t\tconst newSize = value\n\t\tif (!isNaN(newSize))\n\t\t\tsetDrawToolSettings(settings.drawColor, newSize)\n\t}\n\n\tconst setFogOpacity = (value) => {\n\t\tconst newOpacity = value\n\t\tif (!isNaN(newOpacity))\n\t\t\tsetFogToolSettings(newOpacity, settings.fogRadius)\n\t}\n\n\tconst setFogRadius = (value) => {\n\t\tconst newRadius = value\n\t\tif (!isNaN(newRadius))\n\t\t\tsetFogToolSettings(settings.fogOpacity, newRadius)\n\t}\n\n\tconst resetFogOnCurrentMap = () => {\n\t\tresetFog()\n\t}\n\n\tconst resetDrawOnCurrentMap = () => {\n\t\tresetDraw()\n\t}\n\n\treturn (\n\t\t<span>\n\t\t\t<ToolControlsView \n\t\t\t\ttool={ settings.tool } \n\t\t\t\tsubtool={ settings.subtool } \n\t\t\t\tdrawColor={ settings.drawColor } \n\t\t\t\tsetDrawColor={ setDrawColor } \n\t\t\t\tdrawSize={ settings.drawSize } \n\t\t\t\tsetDrawSize={ setDrawSize } \n\t\t\t\tfogOpacity={ settings.fogOpacity } \n\t\t\t\tsetFogOpacity={ setFogOpacity } \n\t\t\t\tfogRadius={ settings.fogRadius } \n\t\t\t\tsetFogRadius={ setFogRadius } \n\t\t\t\tsetSubtool={ setSubtool } \n\t\t\t\tresetFog={ resetFogOnCurrentMap } \n\t\t\t\tresetDrawing={ resetDrawOnCurrentMap } />\n\t\t</span>\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tsettings: state.settings,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tsetToolSettings,\n\tsetDrawToolSettings,\n\tsetFogToolSettings,\n\tresetFog,\n\tresetDraw,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolControls)\n","import Button from './Button.js'\n\nconst MapConfigView = ({ isSelected, mapConfigState, load, onTextChange, onIntegerChange, deleteMap }) => {\n\treturn (\n\t\t<div className={ isSelected ? 'selected' : null }>\n\t\t\t{ mapConfigState.name }\n\t\t\t<input value={ mapConfigState.imageUrl || '' } placeholder='Map url' size='8' onChange={ (e) => onTextChange('imageUrl', e) } />\n\t\t\tw:\n\t\t\t<input value={ mapConfigState.width || 0 } placeholder='width' className='text3' onChange={ (e) => onIntegerChange('width', e) } type='number' min='0' step='10' title='width' />\n\t\t\th:\n\t\t\t<input value={ mapConfigState.height || 0 } placeholder='height' className='text3' onChange={ (e) => onIntegerChange('height', e) } type='number' min='0' step='10' title='height' />\n\t\t\t<Button title='Save & load map' value='&#x1f4c0;' onClick={ load } />\n\t\t\t<Button title='Delete map' value='&#x1f5d1;' onClick={ deleteMap } />\n\t\t</div>\n\t)\n}\n\nexport default MapConfigView\n","import React, { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { loadMap, updateMaps, deleteMap, setIsFogLoaded, setIsFirstLoadDone } from '../reducers/gameReducer.js'\nimport { pushMapState, useWebSocket } from '../hooks/useSocket.js'\nimport MapConfigView from '../views/MapConfigView.js'\n\nconst initialMapConfigState = (map, game) => {\n\tconst existingMap = game.maps.filter((mapElement) => mapElement.$id === map.$id)\n\tconst currentMap = existingMap.length > 0 ? existingMap[0] : { name: undefined, imageUrl: undefined, w: undefined, h: undefined, }\n\n\treturn {\n\t\t$id: parseInt(map.$id),\n\t\tname: currentMap.name ? currentMap.name : map.name,\n\t\timageUrl: currentMap.imageUrl ? currentMap.imageUrl : '',\n\t\twidth: currentMap.width ? currentMap.width : window.innerWidth,\n\t\theight: currentMap.height ? currentMap.height : window.innerHeight,\n\t\tx: 0,\n\t\ty: 0,\t\n\t}\n}\n\nconst MapConfig = ({ map, game, loadMap, updateMaps, deleteMap, setIsFogLoaded, setIsFirstLoadDone }) => {\n\tconst [mapConfigState, setMapConfigState] = useState(initialMapConfigState(map, game))\n\tconst [webSocket, wsSettings] = useWebSocket()\n\tconst isSelected = game.mapId === map.$id\n\n\tconst onTextChange = (key, evt) => {\n\t\tsetMapConfigState({\n\t\t\t...mapConfigState,\n\t\t\t[key]: evt.target.value,\n\t\t})\n\t}\n\n\tconst onIntegerChange = (key, evt) => {\n\t\tconst value = parseInt(evt.target.value) || undefined\n\t\tsetMapConfigState({\n\t\t\t...mapConfigState,\n\t\t\t[key]: value,\n\t\t})\n\t}\n\n\tconst load = () => {\n\t\tconst updatedMaps = game.maps.map((currMap) => {\n\t\t\treturn map.$id === currMap.$id ? { ...currMap, imageUrl: mapConfigState.imageUrl, width: mapConfigState.width, height: mapConfigState.height, } : currMap\n\t\t})\n\t\tupdateMaps(updatedMaps)\n\t\tloadMap(map.$id)\n\t\tsetIsFogLoaded(true)\n\t\tsetIsFirstLoadDone(true)\n\t\tpushMapState(webSocket, wsSettings, updatedMaps, map.$id)\n\t}\n\n\tconst deleteCurrentMap = () => {\n\t\tif (window.confirm('Delete map?')) {\n\t\t\tdeleteMap(map.$id)\n\t\t}\n\t}\n\n\treturn (\n\t\tmap ?\n\t\t\t<MapConfigView \n\t\t\t\tisSelected={ isSelected } \n\t\t\t\tmapConfigState={ mapConfigState }  \n\t\t\t\tload={ load } \n\t\t\t\tonTextChange={ onTextChange } \n\t\t\t\tonIntegerChange={ onIntegerChange } \n\t\t\t\tdeleteMap={ deleteCurrentMap }\n\t\t\t/>\n\t\t: null\n\t)\n}\n\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tloadMap,\n\tupdateMaps,\n\tdeleteMap,\n\tsetIsFogLoaded,\n\tsetIsFirstLoadDone,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MapConfig)\n","import MapConfig from '../components/MapConfig.js'\nimport Button from './Button.js'\n\nconst MapToolView = ({ maps, newMapName, setNewMapName, createMap }) => {\n\treturn (\n\t\t<div>\n\t\t\t<hr />\n\t\t\t<div>\n\t\t\t<input placeholder='New map name' onChange={ (e) => setNewMapName(e.target.value) } value={ newMapName } />\n\t\t\t<Button title='Create new map' value='&#x2795;' onClick={ createMap } disabled={ newMapName === '' } />\n\t\t\t{ maps.map((map) => (\n\t\t\t\t<MapConfig key={ `map${map.$id}` } map={ map } />\n\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default MapToolView\n","import { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { pushCreateMap, useWebSocket } from '../hooks/useSocket.js'\nimport { addMap } from '../reducers/gameReducer.js'\nimport MapToolView from '../views/MapToolView.js'\n\nconst MapTool = ({ toggleOnMaps, game, addMap }) => {\n    const [newMapName, setNewMapName] = useState('')\n\tconst [webSocket, wsSettings, _setWsSettings] = useWebSocket()\n\n\tconst maps = game.maps\n\n    const createMap = () => {\n\t\taddMap(newMapName, window.innerWidth, window.innerHeight)\n\t\tsetNewMapName('')\n\t\tpushCreateMap(webSocket, wsSettings, newMapName, window.innerWidth, window.innerHeight)\n\t}\n\n\treturn (\n        toggleOnMaps ?\n\t\t    <MapToolView maps={ maps } newMapName={ newMapName } setNewMapName={ setNewMapName } createMap={ createMap } />\n            : null\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nconst mapDispatchToProps = {\n\taddMap,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MapTool)\n","import Button from './Button.js'\n\nconst HostTokenConfigView = ({ maps, token, copy, onToggle, selectToken, onTextChange, onIntegerChange, onMapSelect, deleteToken }) => {\n\treturn (\n\t\t<div className='tokenConfig'>\n\t\t\t<Button title='Duplicate token' value='&#x1f46f;' onClick={ copy } />\n\t\t\t<Button value={ token.pc ? '\\u{1f5a5}' : '\\u{1f464}' } onClick={ (e) => onToggle('pc', e) } title='pc/npc' />\n\t\t\t<Button value={ token.$selected ? '\\u{2705}' : '\\u{274C}' } onClick={ (e) => selectToken(token, e) } title='(un)select' />\n\t\t\t<Button value={ token.ko ? '\\u{1f940}' : '\\u{1f339}' } onClick={ (e) => onToggle('ko', e) } title='alive/dead' />\n\t\t\t<input value={ token.name || '' } placeholder='Name' size='8' onChange={ (e) => onTextChange('name', e) } />\n\t\t\t<input value={ token.url || '' } placeholder='Url' size='8' onChange={ (e) => onTextChange('url', e) } />\n\t\t\twh:\n\t\t\t<input value={ token.width || '' } placeholder='w' className='text2' onChange={ (e) => onIntegerChange('width', e) } type='number' step='5' min='0' title='width' />\n\t\t\t<input value={ token.height || '' } placeholder='h' className='text2' onChange={ (e) => onIntegerChange('height', e) } type='number' step='5' min='0' title='height' />\n\t\t\txy:\n\t\t\t<input value={ token.x || '' } placeholder='x' className='text3' onChange={ (e) => onIntegerChange('x', e) } type='number' step='5' title='x coord' />\n\t\t\t<input value={ token.y || '' } placeholder='y' className='text3' onChange={ (e) => onIntegerChange('y', e) } type='number' step='5' title='y coord' />\n\t\t\t<select defaultValue={ token.mapId } onChange={ (e) => onMapSelect(e) } title='which map'>\n\t\t\t\t<option key={ -1 } value={ -1 }>(all)</option>\n\t\t\t\t{ maps.map((map) => (\n\t\t\t\t\t<option key={ map.$id } value={ map.name }>{ maps.name }</option>\n\t\t\t\t))}\n\t\t\t</select>\n\t\t\t<Button title='Delete token' value='&#x1f5d1;' onClick={ deleteToken } />\n\t\t</div>\n\t)\n}\n\nexport default HostTokenConfigView\n","const GuestTokenConfigView = ({ token, onTextChange, onIntegerChange }) => {\n\treturn (\n\t\t<div className='tokenConfig'>\n\t\t\t<input value={ token.name || '' } placeholder='Name' size='8' onChange={ (e) => onTextChange('name', e) } />\n\t\t\t<input value={ token.url || '' } placeholder='Url' size='8' onChange={ (e) => onTextChange('url', e) } />\n\t\t\twh:\n\t\t\t<input value={ token.width || '' } placeholder='w' className='text2' onChange={ (e) => onIntegerChange('width', e) } type='number' step='5' min='0' title='width' />\n\t\t\t<input value={ token.height || '' } placeholder='h' className='text2' onChange={ (e) => onIntegerChange('height', e) } type='number' step='5' min='0' title='height' />\n\t\t\txy:\n\t\t\t<input value={ token.x || '' } placeholder='x' className='text3' onChange={ (e) => onIntegerChange('x', e) } type='number' step='5' title='x coord' />\n\t\t\t<input value={ token.y || '' } placeholder='y' className='text3' onChange={ (e) => onIntegerChange('y', e) } type='number' step='5' title='y coord' />\n\t\t</div>\n\t)\n}\n\nexport default GuestTokenConfigView\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { deleteToken, copyToken, updateTokenValue, toggleTokenValue, updateTokens } from '../reducers/gameReducer.js'\nimport HostTokenConfig from '../views/HostTokenConfigView.js'\nimport GuestTokenConfigView from '../views/GuestTokenConfigView.js'\n\nconst TokenConfig = ({ token, game, metadata, deleteToken, copyToken, updateTokenValue, toggleTokenValue }) => {\n\tconst selectToken = (token, tokenSelected) => {\n\t\tif (!token.pc && !metadata.isHost)\n\t\t\treturn\n\t\tconst updatedTokens = game.tokens.map((currToken) => {\n\t\t\t//TODO: Handle Multiselection / singleselection\n\t\t\treturn (currToken.guid === token.guid) ?\n\t\t\t\t{\n\t\t\t\t\t...currToken,\n\t\t\t\t\t$selected: tokenSelected ? tokenSelected : !currToken.$selected,\n\t\t\t\t\t$x0: currToken.x,\t//TODO: these coordinates should only be set, if selected = true\n\t\t\t\t\t$y0: currToken.y,\t//TODO: these coordinates should only be set, if selected = true\n\t\t\t\t}\n\t\t\t\t: currToken\n\t\t})\n\t\tupdateTokens(updatedTokens)\n\t}\n\n\tconst deleteCurrToken = () => {\n\t\tdeleteToken(token.guid)\n\t}\n\t\n\tconst copy = () => {\n\t\tcopyToken(token.guid)\n\t}\n\n\tconst onMapSelect = (e) => {\n\t\tlet value = parseInt(e.target.value)\n\t\tif (value < 0)\n\t\t\tvalue = undefined\n\t\tupdateTokenValue(token.guid, 'mapId', value)\n\t}\n\n\tconst onToggle = (key) => {\n\t\ttoggleTokenValue(token.guid, key)\n\t}\n\n\tconst onIntegerChange = (key, e) => {\n\t\tupdateTokenValue(token.guid, key, parseInt(e.target.value) || undefined)\n\t}\n\n\tconst onTextChange = (key, e) => {\n\t\tupdateTokenValue(token.guid, key, e.target.value)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t{ token ?\n\t\t\t\tmetadata.isHost ?\n\t\t\t\t<HostTokenConfig \n\t\t\t\t\tmaps={ game.maps } \n\t\t\t\t\ttoken={ token } \n\t\t\t\t\tcopy={ copy } \n\t\t\t\t\tonToggle={ onToggle } \n\t\t\t\t\tselectToken={ selectToken } \n\t\t\t\t\tonTextChange={ onTextChange } \n\t\t\t\t\tonIntegerChange={ onIntegerChange } \n\t\t\t\t\tonMapSelect={ onMapSelect } \n\t\t\t\t\tdeleteToken={ deleteCurrToken }\n\t\t\t\t/>\n\t\t\t\t:\n\t\t\t\t<GuestTokenConfigView \n\t\t\t\t\ttoken={ token } \n\t\t\t\t\tonTextChange={ onTextChange } \n\t\t\t\t\tonIntegerChange={ onIntegerChange }\n\t\t\t\t/>\n\t\t\t: null\n\t\t\t}\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t\tmetadata: state.metadata,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tdeleteToken,\n\tcopyToken,\n\tupdateTokenValue,\n\ttoggleTokenValue,\n\tupdateTokens,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TokenConfig)\n","import TokenConfig from '../components/TokenConfig.js'\nimport Button from './Button.js'\n\nconst TokenToolView = ({ newTokenUrl, setNewTokenUrl, createToken, tokens }) => {\n\treturn (\n\t\t<div>\n\t\t\t<hr />\n\t\t\t<input placeholder='New token url' onChange={ (e) => setNewTokenUrl(e.target.value) } value={ newTokenUrl } />\n\t\t\t<Button title='Create new token' value='&#x2795;' onClick={ createToken } />\n\t\t\t{ tokens.map((token, $i) => (\n\t\t\t\t<TokenConfig key={ `token${$i}` } token={ token } />\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nexport default TokenToolView\n","import TokenConfig from '../components/TokenConfig.js'\n\nconst SelectedTokensControlsView = ({ tokens }) => {\n\tconst filteredTokens = tokens.filter(t => t.$selected)\n\treturn (\n\t\t<div>\n\t\t\t{ filteredTokens.map((token, $i) => (\n\t\t\t\t<TokenConfig key={ `token${$i}` } token={ token } />\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nexport default SelectedTokensControlsView\n","import { connect } from 'react-redux'\nimport SelectedTokensControlsView from '../views/SelectedTokensControlsView.js'\n\nconst SelectedTokensControls = ({ game }) => {\n\tconst filteredTokens = game.tokens.filter(t => t.$selected)\n\treturn (\n\t\t<SelectedTokensControlsView tokens={ filteredTokens } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t}\n}\n\nexport default connect(mapStateToProps, undefined)(SelectedTokensControls)\n","import { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { addToken } from '../reducers/gameReducer.js'\nimport TokenToolView from '../views/TokenToolView.js'\nimport SelectedTokensControls from './SelectedTokensControls.js'\n\nconst TokenTool = ({ toggleOnTokens, game, addToken, metadata }) => {\n    const [newTokenUrl, setNewTokenUrl] = useState('')\n\n\tif (!metadata.isHost)\n\t\treturn null\n\n    const createToken = () => {\n        if (!newTokenUrl)\n            return\n        addToken(undefined, newTokenUrl, game.mapId)\n        setNewTokenUrl('')\n    }\n\n    return (\n        toggleOnTokens ?\n            <TokenToolView newTokenUrl={ newTokenUrl } setNewTokenUrl={ setNewTokenUrl } createToken={ createToken } tokens={ game.tokens } /> :\n            <SelectedTokensControls tokens={ game.tokens } />\n    )\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n        metadata: state.metadata,\n\t}\n}\n\nconst mapDispatchToProps = {\n\taddToken,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TokenTool)\n","import Button from './Button.js'\n\nconst UserToolView = ({ initAsDev, toggleFog, copyJson, pasteJson, username, updateUsername, cursorSize, updateCursorSize }) => {\n\treturn (\n\t\t<div>\n\t\t\t<hr />\n\t\t\t<input title='User name' placeholder='User name' value={ username} onChange={ (e) => updateUsername(e.target.value) } />\n\t\t\t{ /* TODO: enable the mousesharing <ToggleButton title='Share mouse (cursor)' value='&#x1f401;' controlPanelState={ controlPanelState } setControlPanelState={ setControlPanelState } /> */ }\n\t\t\t<input title='Cursor size' value={ cursorSize } onChange={ (e) => updateCursorSize(e.target.value) } type='number' min='0' />\n\t\t\t<hr />\n\t\t\t<Button title='Redo as dev' value='&#x1f530;' onClick={ initAsDev } />\n\t\t\t<Button title='Toggle fog' value='&#127787;' onClick={ toggleFog } />\n\t\t\t<Button title='Copy JSON to clipboard' value='&#x1f46f;' onClick={ copyJson } />\n\t\t\t<Button title='Paste JSON from clipboard' value='&#x1f4cb;' onClick={ pasteJson } />\n\t\t</div>\n\t)\n}\n\nexport default UserToolView\n","import { connect } from 'react-redux'\nimport { setFogEnabled } from '../reducers/gameReducer.js'\nimport { setUsername, setCursorSize, setToolSettings } from '../reducers/settingsReducer.js'\nimport { pushFogEnabled, useWebSocket } from '../hooks/useSocket.js'\nimport UserToolView from '../views/UserToolView.js'\n\nconst UserTool = ({ toggleOnUser, game, settings, setFogEnabled, setUsername, setCursorSize, setToolSettings }) => {\n    const [webSocket, wsSettings, setWsSettings] = useWebSocket()\n\tif (!toggleOnUser)\n\t\treturn null\n\n    const updateUsername = (value) => {\n        setUsername(value)\n        setWsSettings({\n\t\t\t...wsSettings,\n\t\t\tusername: value,\n\t\t})\n    }\n\n    const updateCursorSize = (value) => {\n        const newSize = value\n\t\tif (!isNaN(newSize))\n\t\t\tsetCursorSize(newSize)\n    }\n\n    const initAsDev = () => {\n        //TODO: implement new init as dev\n        /*\n        const initAsDev = () => {\n            if (!window.confirm('Reset?'))\n                return null\n            let tokens = [\n                { name: 'bar', pc: 0 },\n                { name: 'foo', url: '/dev/belmont.jpg' },\n                { name: 'arr', pc: 1 },\n                { name: 'win', pc: 1, url: '/dev/redhead.jpg', y: 50, x: 90, w: 64, h:64 },\n            ]\n            let maps = [\n                {\n                    name: 'kiwi',\n                    imageUrl: '/dev/kiwi.jpeg',\n                    $id: 0,\n                    width: 500,\n                    height: 500,\n                    x: 0,\n                    y: 0,\n                    drawPaths: [],\n                    fogPaths: [],\n                },\n                {\n                    name: 'default',\n                    imageUrl: '/dev/FFtri9T.png',\n                    spawnX: 40,\n                    spawnY: 80,\n                    $id: 1,\n                    x: 0,\n                    y: 0,\n                    drawPaths: [],\n                    fogPaths: [],\n                }\n            ]\n            return new Promise(resolve => {\n                setGameState({\n                    ...gameState,\n                    game: {\n                        ...gameState.game,\n                        maps: maps,\n                        tokens: tokens,\n                        mapId: 0,\n                    },\n                })\n                resolve()\n            })\n        }\n        */\n    }\n\n    const toggleFog = () => {\n        setFogEnabled(!game.fogEnabled)\n        pushFogEnabled(webSocket, wsSettings, !game.fogEnabled)\n        if (settings.tool === 'fog')\n            setToolSettings('move','')\n    }\n\n    const copyJson = () => {\n\t\t//TODO: Implement CopyJson\n\t\t/*\n\t\tconst json = gameState.toJson()\n\t\twindow.navigator.clipboard.writeText(json).then(() => {\n\t\t\tnotify('copied to clipboard')\n\t\t}).catch(err => {\n\t\t\tconsole.error('failed to write to clipboard: ', err)\n\t\t\tnotify(`failed to write to clipboard: ${err}`, 2000)\n\t\t})\n\t\t*/\n\t}\n\n\tconst pasteJson = () => {\n\t\t//TODO: Implement PasteJson\n\t\t/*\n\t\tconst note1 = notify('reading clipboard...')\n\t\twindow.navigator.clipboard.readText().then(json => {\n\t\t\tif (window.confirm(`Do you really want to overwrite this game with what's in your clipboard? ${json.slice(0,99)}...`)) {\n\t\t\t\tfromJson(json)\n\t\t\t\tnotify('pasted from clipboard')\n\t\t\t}\n\t\t\tnote1 && note1.close()\n\t\t}).catch(err => {\n\t\t\tconsole.error('failed to read clipboard: ', err)\n\t\t\tnotify(`failed to read clipboard: ${err}`, 2000)\n\t\t})\n\t\t*/\n\t}\n\n\treturn (\n        toggleOnUser ?\n\t\t    <UserToolView\n                initAsDev={ initAsDev } \n                toggleFog={ toggleFog } \n                copyJson={ copyJson } \n                pasteJson={ pasteJson } \n                username={ settings.username } \n                updateUsername={ updateUsername } \n                cursorSize={ settings.cursorSize } \n                updateCursorSize={ updateCursorSize } />\n            : null\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n        settings: state.settings,\n\t}\n}\n\nconst mapDispatchToProps = {\n    setUsername,\n\tsetCursorSize,\n    setFogEnabled,\n    setToolSettings,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserTool)\n","import Button from '../views/Button.js'\nimport { connect } from 'react-redux'\nimport { setToolSettings } from '../reducers/settingsReducer.js'\n\nfunction ToolButton({ title, value, settings, setToolSettings }) {\n\tconst isSelected = title === settings.tool\n\tconst onClick = () => {\n\t\tsetToolSettings(title, undefined)\n\t}\n\treturn (\n\t\t<Button title={ title } value={ value.toString() } onClick={ onClick } isSelected={ isSelected } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tsettings: state.settings,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tsetToolSettings,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolButton)\n","import ToolButton from '../components/ToolButton.js'\n\nconst ToolSelectView = ({ fogEnabled }) => {\n\treturn (\n\t\t<span id='tools'>\n\t\t\t<ToolButton title='move' value='&#x1f9f3;' />\n\t\t\t<ToolButton title='draw' value='&#x1f58d;' />\n\t\t\t{ fogEnabled ? <ToolButton title='fog'  value='&#x1f32c;' /> : null }\n\t\t</span>\n\t)\n}\n\nexport default ToolSelectView\n","import ToggleButton from '../components/ToggleButton.js'\nimport ToolControls from '../components/ToolControls.js'\nimport MapTool from '../components/MapTool.js'\nimport TokenTool from '../components/TokenTool.js'\nimport UserTool from '../components/UserTool.js'\nimport SelectedTokensControls from '../components/SelectedTokensControls.js'\nimport ToolSelectView from './ToolSelectView.js'\nimport Button from './Button.js'\n\nconst ControlPanelView = ({ controlPanelState, setControlPanelState, hidden, toggleHidden, fogEnabled, isHost, username, setUsername, cursorSize, setCursorSize, socketRequestRefresh, pushRefreshToPlayers }) => {\n\tif (hidden)\n\t\treturn (\n\t\t\t<div id='control-panel'>\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t<Button value='&#x1f441;' onClick={ toggleHidden } title='show/hide control panel' />\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t</div>\n\t\t)\n\t\n\tif (isHost)\n\t\treturn (\n\t\t\t<div id='control-panel'>\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t<Button value='&#x1f441;' onClick={ toggleHidden } title='show/hide control panel' />\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t<ToggleButton title='User' value='&#x1f9d9;&#x200d;&#x2642;&#xfe0f;' controlPanelState={ controlPanelState } setControlPanelState={ setControlPanelState } />\n\t\t\t\t<ToggleButton title='Maps' value='&#x1f5fa;' controlPanelState={ controlPanelState } setControlPanelState={ setControlPanelState } />\n\t\t\t\t<ToggleButton title='Tokens' value='&#x265f;' controlPanelState={ controlPanelState } setControlPanelState={ setControlPanelState } />\n\t\t\t\t<Button title='Push refresh to players' value='&#x1f4ab;' onClick={ pushRefreshToPlayers } />\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t<ToolSelectView fogEnabled={ fogEnabled } />\n\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t<ToolControls />\n\t\t\t\t<MapTool toggleOnMaps={ controlPanelState.toggleOnMaps } />\n\t\t\t\t<TokenTool toggleOnTokens={ controlPanelState.toggleOnTokens } />\n\t\t\t\t<UserTool toggleOnUser={ controlPanelState.toggleOnUser } />\n\t\t\t</div>\n\t\t)\n\telse\n\t\treturn (\n\t\t\t<div id='control-panel'>\n\t\t\t\t<Button value='&#x1f441;' onClick={ toggleHidden } title='show/hide control panel' />\n\t\t\t\t<input title='User name' placeholder='User name' value={ username } onChange={ (e) => setUsername(e.target.value) } />\n\t\t\t\t<ToggleButton title='Share mouse (cursor)' value='&#x1f401;' controlPanelState={ controlPanelState } setControlPanelState={ setControlPanelState } />\n\t\t\t\t<input title='Cursor size' value={ cursorSize } onChange={ (e) => setCursorSize(parseInt(e.target.value)) } type='number' min='0' />\n\t\t\t\t<Button title='Request gameboard refresh from host' onClick={ socketRequestRefresh } value='&#x1f4ab;' />\n\t\t\t\t<SelectedTokensControls />\n\t\t\t</div>\n\t\t)\n}\n\nexport default ControlPanelView\n","import React, { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { setUsername, setCursorSize } from '../reducers/settingsReducer.js' \nimport { pushGameRefresh, requestRefresh, useWebSocket } from '../hooks/useSocket.js'\nimport ControlPanelView from '../views/ControlPanelView.js'\n\nconst initialControlPanelState = () => {\n\treturn {\n\t\thidden: false,\n\t\ttoggleOnMaps: false,\n\t\ttoggleOnUser: false,\n\t\ttoggleOnTokens: false,\n\t}\n}\n\nconst ControlPanel = ({ game, settings, metadata, setUsername, setCursorSize }) => {\n\tconst [controlPanelState, setControlPanelState] = useState(initialControlPanelState)\n\tconst [webSocket, wsSettings, setWsSettings] = useWebSocket()\n\n\tconst toggleHidden = () => {\n\t\tsetControlPanelState({\n\t\t\t...controlPanelState,\n\t\t\thidden: !controlPanelState.hidden,\n\t\t})\n\t}\n\n\tconst updateUsername = (value) => {\n\t\tsetUsername(value)\n\t\tsetWsSettings({\n\t\t\t...wsSettings,\n\t\t\tusername: value,\n\t\t})\n\t}\n\n\tconst updateCursorSize = (value) => {\n\t\tconst newSize = value\n\t\tif (!isNaN(newSize))\n\t\t\tsetCursorSize(newSize)\n\t}\n\n\tconst socketRequestRefresh = () => {\n\t\trequestRefresh(webSocket, wsSettings)\n\t}\n\n\tconst pushRefreshToPlayers = () => {\n\t\tpushGameRefresh(webSocket, wsSettings, game)\n\t}\n\n\treturn (\n\t\t<ControlPanelView \n\t\t\tcontrolPanelState={ controlPanelState } \n\t\t\tsetControlPanelState={ setControlPanelState } \n\t\t\thidden={ controlPanelState.hidden } \n\t\t\ttoggleHidden={ toggleHidden } \n\t\t\tfogEnabled={ game.fogEnabled }\n\t\t\tisHost={ metadata.isHost } \n\t\t\tusername={ settings.username } \n\t\t\tsetUsername={ updateUsername } \n\t\t\tcursorSize={ settings.cursorSize } \n\t\t\tsetCursorSize={ updateCursorSize } \n\t\t\tsocketRequestRefresh={ socketRequestRefresh } \n\t\t\tpushRefreshToPlayers={ pushRefreshToPlayers } />\n\t)\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tgame: state.game,\n\t\tsettings: state.settings,\n\t\tmetadata: state.metadata,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tsetUsername,\n\tsetCursorSize,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ControlPanel)\n","import Background from '../components/Background.js'\nimport Drawing from '../components/Drawing.js'\nimport Fog from '../components/Fog.js'\nimport Overlay from '../components/Overlay.js'\nimport Token from '../components/Token.js'\nimport Cursor from './Cursor.js'\nimport ControlPanel from '../components/ControlPanel.js'\n\nconst GameView = ({ isHost, overlayRef, isFogLoaded, cursors, cursorSize, tokens, onMouseMove, onMouseUp, onMouseDown }) => {\n\tconst goneClass = isFogLoaded ? null : 'gone'\n\n\treturn (\n\t\t<div id='game' onMouseMove={ (e) => onMouseMove(e) } onMouseDown={ (e) => onMouseDown(e) } onMouseUp={ (e) => onMouseUp(e) }>\n\t\t\t<div className={ goneClass }>\n\t\t\t\t<Background />\n\t\t\t\t<Drawing />\n\t\t\t\t{ tokens ? \n\t\t\t\t\t<div id='tokens'>\n\t\t\t\t\t\t{ tokens.map((token, $i) => (\n\t\t\t\t\t\t\t<Token key={ `Token${$i}` } token={ token } isHost={ isHost } />\n\t\t\t\t\t\t)) }\n\t\t\t\t\t</div>\n\t\t\t\t\t: null\n\t\t\t\t}\n\t\t\t\t<Fog />\n\t\t\t\t{ cursors ?\n\t\t\t\t\t<div id='cursors'>\n\t\t\t\t\t\t{ cursors.map((cursor) => (\n\t\t\t\t\t\t\t<Cursor key={ `cursor${cursor.$id}` } name={ cursor.username } cursor={ cursor } size={ cursorSize } />\n\t\t\t\t\t\t)) }\n\t\t\t\t\t</div>\n\t\t\t\t\t: null\n\t\t\t\t}\n\t\t\t\t{/* Overlay: Holds outline for fog & draw tools */ }\n\t\t\t\t<Overlay overlayRef={ overlayRef } /> \n\t\t\t</div>\n\t\t\t<ControlPanel />\n\t\t</div>\n\t)\n}\n\nexport default GameView\n","import React, { useEffect, useCallback } from 'react'\nimport { connect } from 'react-redux'\nimport { setGameSettings } from '../reducers/metadataReducer.js'\nimport { overwriteGame, updateMaps, loadMap, addMap, incrementGen, setFogEnabled } from '../reducers/gameReducer.js'\nimport { pushDrawPath, pushFogPath, pushGameRefresh, useWebSocket } from '../hooks/useSocket.js'\nimport GameView from '../views/GameView.js'\n\nconst Game = ({ metadata, game, settings, setGameSettings, overwriteGame, loadMap, updateMaps, addMap, incrementGen, setFogEnabled }) => {\n\tconst overlayRef = React.useRef()\n\tconst [webSocket, wsSettings, setWsSettings] = useWebSocket()\n\tlet currentPath = []\n\n\t/****************************************************\n\t * Map Functions                                    *\n\t ****************************************************/\n\tconst getMap = () => {\n\t\tif (game.maps.length === 0)\n\t\t\treturn undefined\n\t\tconst currMap = game.maps.filter((map) => map.$id === game.mapId)\n\t\treturn currMap.length > 0 ? currMap[0] : game.maps[0]\n\t}\n\n\t/****************************************************\n\t * Update Functions                                 *\n\t ****************************************************/\n\t/*\n\tconst updateCursors = (x, y, name, guid) => {\n\t\tconst cursors = Object.assign({}, gameState.metadata.cursors)\n\t\tcursors[guid] = { x: x, y: y, time: new Date(), u: name }\n\t\tsetGameState({\n\t\t\t...gameState,\n\t\t\tmetadata: {\n\t\t\t\t...gameState.metadata,\n\t\t\t\tcursors: cursors,\n\t\t\t},\n\t\t})\n\t}\n\t*/\n\n\t/****************************************************\n\t * Control Functions                                *\n\t ****************************************************/\n\tconst dragSelectedTokens = (e) => {\n\t\t//TODO: Update dragSelectedTokens\n\t\t/*\n\t\tif (gameState.settings.tool !== 'move')\n\t\t\treturn\n\t\tconst downX = gameState.metadata.downX, downY = gameState.metadata.downY\n\t\tupdateTokens((token) => {\n\t\t\tif (token.$selected) {\n\t\t\t\ttoken.x = token.$x0 + e.pageX - downX\n\t\t\t\ttoken.y = token.$y0 + e.pageY - downY\n\t\t\t}\n\t\t\treturn token\n\t\t}, false, undefined)\n\t\t*/\n\t}\n\n\t/****************************************************\n\t * Drawing Functions                                *\n\t ****************************************************/\n\tconst setPointerOutline = (x, y, color, radius) => {\n\t\tif (color == null)\n\t\t\treturn\n\t\tconst ctx = overlayRef.current.getContext('2d')\n\t\tctx.strokeStyle = color\n\t\tctx.lineWidth = '3'\n\t\tctx.beginPath()\n\t\tctx.arc(x, y, radius, 0, 2*Math.PI)\n\t\tctx.stroke()\n\t\tctx.closePath()\n\t}\n\n\tconst updateCurrentDrawPath = () => {\n\t\tconst ctx = overlayRef.current.getContext('2d')\n\t\tctx.beginPath()\n\t\tfor (let pointId = 0; pointId < currentPath.length; pointId++) {\n\t\t\tctx.lineCap = 'round'\n\t\t\tctx.fillStyle = currentPath[pointId].drawColor\n\t\t\tctx.lineWidth = currentPath[pointId].drawSize\n\t\t\tctx.strokeStyle = currentPath[pointId].drawColor\n\t\t\tif (pointId === 0) {\n\t\t\t\tctx.moveTo(currentPath[pointId].x, currentPath[pointId].y)\n\t\t\t} else {\n\t\t\t\tctx.lineTo(currentPath[pointId].x, currentPath[pointId].y)\n\t\t\t}\n\t\t}\n\t\tctx.stroke()\n\t}\n\n\tconst updateCurrentFogPath = () => {\n\t\tconst ctx = overlayRef.current.getContext('2d')\n\t\tctx.beginPath()\n\t\tlet gradient\n\t\tfor (let pointId = 0; pointId < currentPath.length; pointId++) {\n\t\t\tgradient = ctx.createRadialGradient(currentPath[pointId].x, currentPath[pointId].y, currentPath[pointId].r2 || 1, currentPath[pointId].x, currentPath[pointId].y, currentPath[pointId].r*0.75)\n\t\t\tctx.lineCap = 'round'\n\t\t\tgradient.addColorStop(0, 'rgba(255,255,255,255)')\n\t\t\tgradient.addColorStop(1, 'rgba(255,255,255,0)')\n\t\t\tctx.fillStyle = gradient\n\t\t\tctx.fillRect(currentPath[pointId].x-currentPath[pointId].r, currentPath[pointId].y-currentPath[pointId].r, currentPath[pointId].x+currentPath[pointId].r, currentPath[pointId].y+currentPath[pointId].r)\n\t\t}\n\t\tctx.stroke()\n\t}\n\n\tconst clearOverlay = () => {\n\t\tconst ctx = overlayRef.current.getContext('2d')\n\t\tif (!ctx)\n\t\t\treturn\n\t\tctx.clearRect(0, 0, game.width, game.height);\n\t}\n\n\t/****************************************************\n\t * Event Handlers                                   *\n\t ****************************************************/\n\t/* Callback when the window resizes */\n\tconst onResize = () => {\n\t\t//loadMap(null, true, true)\n\t}\n\n\tconst onKeyDown = (e) => {\n\t\t//TODO: Update onKeyDown function\n\t\t/*\n\t\tfor (let x of [document.activeElement, e.target])\n\t\t\t//TODO: Check if we can use triple equal\n\t\t\tif (x.tagName == 'INPUT' && (x.type === 'text' || x.type === 'number')) // eslint-disable-line eqeqeq\n\t\t\t\treturn e\n\t\t\n\t\tconst moveFactor = e.shiftKey ? 100 : 10\n\t\tconst moveSelectedTokens = () => {\n\t\t\tupdateTokens(token => {\n\t\t\t\tif (token.$selected) {\n\t\t\t\t\tswitch (e.keyCode) {\n\t\t\t\t\t\tcase 27: // escape\n\t\t\t\t\t\t\ttoken.$selected = false\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase 37: // left\n\t\t\t\t\t\t\ttoken.x -= moveFactor\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase 38: // up\n\t\t\t\t\t\t\ttoken.y -= moveFactor\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase 39: // right\n\t\t\t\t\t\t\ttoken.x += moveFactor\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase 40: // down\n\t\t\t\t\t\t\ttoken.y += moveFactor\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tdefault: return\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault()\n\t\t\t\t}\n\t\t\t\treturn token\n\t\t\t})\n\t\t}\n\t\tswitch (e.keyCode) {\n\t\t\tcase 27:\n\t\t\tcase 37:\n\t\t\tcase 38:\n\t\t\tcase 39:\n\t\t\tcase 40:\n\t\t\t\tmoveSelectedTokens(e)\n\t\t\t\tbreak\n\t\t\tdefault: return\n\t\t}\n\t\t*/\n\t}\n\n\t/*\n\tconst onKeyPress = (e) => {\n\t\tif (!gameState.metadata.isHost)\n\t\t\treturn e\n\t\tfor (let x of [document.activeElement, e.target])\n\t\t\t//TODO: Check if we can use triple equal\n\t\t\tif ((x.tagName == 'INPUT' && (x.type === 'text' || x.type === 'number')) || (x.tagName == 'BUTTON'))\n\t\t\t\treturn e\n\n\t\tconst cp = gameState.cpRef.current\n\t\tswitch(e.code) {\n\t\t\tcase 'KeyC':\n\t\t\t\tif (e.shiftKey)\n\t\t\t\t\tcp.copyJson() // dump json to clipboard\n\t\t\t\tbreak\n\t\t\tcase 'KeyH':\n\t\t\t\ttoggleControlPanelVisibility('hidden')\n\t\t\t\tbreak\n\t\t\tcase 'KeyG':\n\t\t\t\tsetGameState({\n\t\t\t\t\t...gameState,\n\t\t\t\t\tsettings: {\n\t\t\t\t\t\t...gameState.settings,\n\t\t\t\t\t\ttool: 'fog',\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\tcase 'KeyL':\n\t\t\t\tif (e.shiftKey)\n\t\t\t\t\tloadFromLocalStorage()\n\t\t\t\telse\n\t\t\t\t\tsaveToLocalStorage()\n\t\t\t\tbreak\n\t\t\tcase 'KeyM':\n\t\t\t\ttoggleControlPanelVisibility('toggleOnMaps')\n\t\t\t\tbreak\n\t\t\tcase 'KeyP':\n\t\t\t\tsetGameState({\n\t\t\t\t\t...gameState,\n\t\t\t\t\tsettings: {\n\t\t\t\t\t\t...gameState.settings,\n\t\t\t\t\t\ttool: 'draw',\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\tcase 'KeyT':\n\t\t\t\ttoggleControlPanelVisibility('toggleOnTokens')\n\t\t\t\tbreak\n\t\t\tcase 'KeyV':\n\t\t\t\tif (e.shiftKey)\n\t\t\t\t\tcp.pasteJson() // load json from clipboard\n\t\t\t\telse\n\t\t\t\tsetGameState({\n\t\t\t\t\t...gameState,\n\t\t\t\t\tsettings: {\n\t\t\t\t\t\t...gameState.settings,\n\t\t\t\t\t\ttool: 'move',\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\tdefault: return\n\t\t}\n\t}\n\t*/\n\n\tconst onMouseUp = (e) => {\n\t\tconst currMap = getMap()\n\t\tif (currMap && metadata.isHost) {\n\t\t\tconst fogPaths = currMap.fogPaths\n\t\t\tconst drawPaths = currMap.drawPaths\n\t\t\tswitch (settings.tool) {\n\t\t\t\tcase 'fog':\n\t\t\t\t\tfogPaths.push(currentPath)\n\t\t\t\t\tpushFogPath(webSocket, wsSettings, currentPath)\n\t\t\t\t\tbreak\n\t\t\t\tcase 'draw':\n\t\t\t\t\tdrawPaths.push(currentPath)\n\t\t\t\t\tpushDrawPath(webSocket, wsSettings, currentPath)\n\t\t\t\t\tbreak\n\t\t\t\tdefault: break\n\t\t\t}\n\t\t\tcurrentPath = []\n\t\t\tconst updatedMaps = game.maps.map((map) => {\n\t\t\t\treturn map.$id === currMap.$id ? {...currMap, fogPaths: fogPaths, drawPaths: drawPaths, } : map\n\t\t\t})\n\t\t\t\n\t\t\tupdateMaps(updatedMaps)\n\t\t}\n\t}\n\n\tconst onMouseDown = (e) => {\n\t\tfor (let x of [document.activeElement, e.target])\n\t\t\t//TODO: Check if we can use triple equal\n\t\t\tif ((x.tagName == 'INPUT' && (x.type === 'text' || x.type === 'number')) || (x.tagName == 'BUTTON')) /* eslint-disable-line eqeqeq */\n\t\t\t\treturn e\n\n\t\tif (metadata.isHost) {\n\t\t\tif (e.buttons & 1) {\n\t\t\t\t/*\n\t\t\t\tif (!/(\\s|^)token(\\s|$)/.test(e.target.getAttribute('class')))\n\t\t\t\t\t//TODO: Update to map function\n\t\t\t\t\tupdateTokens(tok => { delete tok.$selected })\n\t\t\t\t*/\n\t\t\t\tcurrentPath = []\n\t\t\t\tcurrentPath.push({\n\t\t\t\t\tx: e.pageX,\n\t\t\t\t\ty: e.pageY,\n\t\t\t\t\tr: settings.fogRadius,\n\t\t\t\t\tr2: undefined,\n\t\t\t\t\ttool: currentTool(),\n\t\t\t\t\tdrawColor: settings.drawColor,\n\t\t\t\t\tdrawSize: settings.drawSize,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tconst onMouseMove = (e) => {\n\t\tconst overlay = overlayRef\n\t\tif (!overlay)\n\t\t\treturn\n\n\t\tclearOverlay()\n\t\tlet x = e.pageX, y = e.pageY\n\t\tswitch (metadata.isHost ? settings.tool : 'move') {\n\t\t\tcase 'fog':\n\t\t\t\tupdateCurrentFogPath()\n\t\t\t\tsetPointerOutline(x, y, 'yellow', settings.fogRadius)\n\t\t\t\tbreak\n\t\t\tcase 'draw':\n\t\t\t\tupdateCurrentDrawPath()\n\t\t\t\tsetPointerOutline(x, y, settings.drawColor, settings.drawSize)\n\t\t\t\tbreak\n\t\t\tcase 'move':\n\t\t\t\tif (e.buttons & 1)\n\t\t\t\t\tdragSelectedTokens(e)\n\t\t\t\tbreak\n\t\t\tdefault: break\n\t\t}\n\t\tif ((settings.tool === 'fog' || settings.tool === 'draw') && (e.buttons & 1)) {\n\t\t\tcurrentPath.push({\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\tr: settings.fogRadius,\n\t\t\t\tr2: undefined,\n\t\t\t\ttool: currentTool(),\n\t\t\t\tdrawColor: settings.drawColor,\n\t\t\t\tdrawSize: settings.drawSize,\n\t\t\t})\n\t\t}\n\t}\n\n\tconst currentTool = () => {\n\t\tconst isEraser = settings.subtool === 'eraser'\n\t\tswitch (settings.tool) {\n\t\t\tcase 'draw':\n\t\t\t\tif (isEraser) {\n\t\t\t\t\treturn 'erease'\n\t\t\t\t} else {\n\t\t\t\t\treturn 'draw'\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn settings.tool\n\t\t}\n\t}\n\n\t/****************************************************\n\t * Helper Functions                                 *\n\t ****************************************************/\n\tconst notify = (msg, ttl, tag) => {\n\t\tconsole.log(msg)\n\t\tif (window.Notification) {\n\t\t\tif (window.Notification.permission !== 'granted')\n\t\t\t\twindow.Notification.requestPermission()\n\t\t\telse {\n\t\t\t\tconst note = new window.Notification(msg, {tag: tag})\n\t\t\t\tsetTimeout(() => note.close(), ttl || 1000)\n\t\t\t\treturn note\n\t\t\t}\n\t\t}\n\t}\n\n\tconst toJson = (additionalAttrs) => {\n\t\t//TODO: rewrite toJson\n\t\t/*\n\t\tconst map = getMap()\n\t\tincrementGen()\n\t\tconst tokens = game.tokens.map(token => ({...token}))\n\t\ttokens.forEach(token => websocket.scrubObject(token))\n\t\tconst maps = game.maps\n\t\tObject.values(maps).forEach(map => websocket.scrubObject(map))\n\t\tconst data = Object.assign({\n\t\t\tgen: game.gen,\n\t\t\tmaps: maps,\n\t\t\tmapId: map && map.$id,\n\t\t\ttokens: tokens,\n\t\t}, additionalAttrs)\n\t\treturn JSON.stringify(data)\n\t\t*/\n\t}\n\n\tconst fromJson = (json) => {\n\t\t//TODO: rewrite fromJson\n\t\t/*\n\t\tconst data = Object.assign(JSON.parse(json)||{})\n\t\tif (data.tokens) {\n\t\t\tdata.tokens.forEach(token => {\n\t\t\t\tif (!token.guid) token.guid = guid()\n\t\t\t})\n\t\t}\n\t\treturn new Promise(resolve => {\n\t\t\tsetGameState({\n\t\t\t\t...gameState,\n\t\t\t\tgame: {\n\t\t\t\t\t...gameState.game,\n\t\t\t\t\tdata,\n\t\t\t\t}\n\t\t\t})\n\t\t\tresolve()\n\t\t})\n\t\t*/\n\t}\n\n\tconst saveToLocalStorage = () => {\n\t\t//TODO: Reenable after we've fixed toJson\n\t\t/*\n\t\tif (game.isFirstLoadDone) {\n\t\t\tconsole.log('Saving game to local storage')\n\t\t\tlocalStorage.setItem(metadata.room, toJson())\n\t\t}\n\t\t*/\n\t}\n\n\tconst loadFromLocalStorage = () => {\n\t\t//TODO: reenable after we've fixed fromJson\n\t\t/*\n\t\t//TODO: Verify how come this does not work anymore\n\t\tconsole.log('Loading game from local storage')\n\t\treturn fromJson(localStorage.getItem(metadata.room))\n\t\t*/\n\t}\n\n\tfunction handleError (ex) {\n\t\tconsole.error(ex)\n\t\tconsole.error('Exception in `render`. Clearing localStorage...')\n\t\tlocalStorage.removeItem(metadata.room)\n\t\twindow.alert('Fatal error. Local storage cleared.')\n\t}\n\n\t/****************************************************\n\t * Receiving Data                                   *\n\t ****************************************************/\n\tconst receiveData = useCallback((evt) => {\n\t\tlet data = JSON.parse(evt.data)\n\t\tif (data.from === wsSettings.guid) {\n\t\t\treturn // ignore messages sent by self\n\t\t}\n\t\tif (data.to && data.to !== wsSettings.guid) {\n\t\t\treturn // ignore messages sent to different recipients\n\t\t}\n\n        const getMap = () => {\n            if (game.maps.length === 0)\n                return undefined\n            const currMap = game.maps.filter((map) => map.$id === game.mapId)\n            return currMap.length > 0 ? currMap[0] : game.maps[0]\n        }\n\n\t\tconst currMap = getMap()\n\t\tswitch (data.type) {\n\t\t\tcase 'pushCursor':\n\t\t\t\t/*\n\t\t\t\tif (data.u !== this.gameState.settings.username)\n\t\t\t\t\tthis.gameState.updateCursors(data.x, data.y, data.u, data.from)\n\t\t\t\t*/\n\t\t\t\tbreak\n\t\t\tcase 'pushDrawPath':\n\t\t\t\tconst newDrawPath = currMap.drawPaths ? currMap.drawPaths : []\n\t\t\t\tnewDrawPath.push(data.drawPath)\n\t\t\t\tconst updatedMapsWithDraw = game.maps.map((map) => {\n\t\t\t\t\treturn map.$id === currMap.$id ? { ...currMap, drawPaths: newDrawPath, } : map\n\t\t\t\t})\n\t\t\t\tupdateMaps(updatedMapsWithDraw)\n\t\t\t\tbreak\n\t\t\tcase 'pushDrawReset':\n\t\t\t\tconst updatedMapsWithDrawReset = game.maps.map((map) => {\n\t\t\t\t\treturn map.$id === currMap.$id ? {...currMap, drawPaths: [], } : map\n\t\t\t\t})\n\t\t\t\tupdateMaps(updatedMapsWithDrawReset)\n\t\t\t\tbreak\n\t\t\tcase 'pushFogPath':\n\t\t\t\tconst newFogPath = currMap.fogPaths ? currMap.fogPaths : []\n\t\t\t\tnewFogPath.push(data.fogPath)\n\t\t\t\tconst updatedMapsWithFog = game.maps.map((map) => {\n\t\t\t\t\treturn map.$id === currMap.$id ? { ...currMap, fogPaths: newFogPath, } : map\n\t\t\t\t})\n\t\t\t\tupdateMaps(updatedMapsWithFog)\n\t\t\t\tbreak\n\t\t\tcase 'pushFogReset':\n\t\t\t\tconst updatedMapsWithFogReset = game.maps.map((map) => {\n\t\t\t\t\treturn map.$id === currMap.$id ? {...currMap, fogPaths: [], } : map\n\t\t\t\t})\n\t\t\t\tupdateMaps(updatedMapsWithFogReset)\n\t\t\t\tbreak\n\t\t\tcase 'pushSingleToken':\n\t\t\t\t/*\n\t\t\t\tconst local = this.gameState.game.tokens[data.i]\n\t\t\t\tconst token = Object.assign(local, data.a) // Keep and `$` attrs like `$selected`\n\t\t\t\tthis.gameState.updateTokenByIndex(data.i, token, true)\n\t\t\t\t*/\n\t\t\t\tbreak\n\t\t\tcase 'pushTokens':\n\t\t\t\t/*\n\t\t\t\tconst localTokensMap = this.gameState.game.tokens.reduce((out, tok) => {\n\t\t\t\t\tout[tok.guid] = tok\n\t\t\t\t\treturn out\n\t\t\t\t}, {})\n\t\t\t\tconst tokens = data.tokens.map(tok => Object.assign({}, localTokensMap[tok.guid], tok))\n\t\t\t\tthis.gameState.setState({tokens: tokens})\n\t\t\t\t*/\n\t\t\t\tbreak\n\t\t\tcase 'pushMapId':\n\t\t\t\tloadMap(data.mapId)\n\t\t\t\tbreak\n\t\t\tcase 'pushMapState':\n\t\t\t\tupdateMaps(data.maps)\n\t\t\t\tloadMap(data.mapId)\n\t\t\t\tbreak\n\t\t\tcase 'pushCreateMap':\n\t\t\t\taddMap(data.mapName, data.width, data.height)\n\t\t\t\tbreak\n\t\t\tcase 'pushFogEnabled':\n\t\t\t\tconsole.log('receiving fog enabled',data)\n\t\t\t\tsetFogEnabled(data.fogEnabled)\n\t\t\t\tbreak\n\t\t\tcase 'pushGameRefresh': // refresh from host\n\t\t\t\toverwriteGame(data.game)\n\t\t\t\tbreak\n\t\t\tcase 'requestRefresh': // refresh request from player\n\t\t\t\tif (metadata.isHost) {\n\t\t\t\t\tpushGameRefresh(webSocket, wsSettings, game, { to: data.from, })\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tconsole.error(`Unrecognized websocket message type: ${data.type}`)\n\t\t}\n\t},[ game, metadata.isHost, loadMap, overwriteGame, updateMaps, addMap, webSocket, wsSettings ])\n\n\t/****************************************************\n\t * React Hooks                                      *\n\t ****************************************************/\n\t// On Mount\n\tuseEffect(() => {\n\t\twindow.addEventListener('beforeunload', saveToLocalStorage)\n\t\twindow.addEventListener('resize', onResize)\n\t\t//TODO: reenable keypresses\n\t\t//window.addEventListener('keypress', onKeyPress)\n\t\twindow.addEventListener('keydown', onKeyDown)\n\t\tloadFromLocalStorage()\n\t\tconst params = new URLSearchParams(window.location.href.replace(/.*\\?/, ''))\n\t\tsetGameSettings(params.get('host'), params.get('room'))\n\n\t\t// On Unmount\n\t\treturn () => {\n\t\t\tsaveToLocalStorage()\n\t\t\twindow.removeEventListener('beforeunload', saveToLocalStorage)\n\t\t\twindow.removeEventListener('resize', onResize)\n\t\t\t//window.removeEventListener('keypress', onKeyPress)\n\t\t\twindow.removeEventListener('keydown', onKeyDown)\n\t\t}\n\t}, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n\tuseEffect(() => {\n\t\tdocument.title = `Borealis D&D, Room: ${metadata.room}`\n\t}, [ metadata.room ])\n\n\tuseEffect(() => {\n\t\tif (webSocket) {\n\t\t\twebSocket.addEventListener('message', receiveData)\n\t\t\tif (wsSettings.username === '')\n\t\t\t\tsetWsSettings({ ...wsSettings, username: settings.username })\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (webSocket)\n\t\t\t\twebSocket.removeEventListener('message', receiveData)\n\t\t}\n\t}, [webSocket, wsSettings, setWsSettings, receiveData, settings.username])\n\t\n\t/*\n\tuseEffect(() => {\n\t\tif (websocket && gameState.settings.shareMouse)\n\t\t\twebsocket.pushCursor(gameState.metadata.lastX, gameState.metadata.lastY)\n\t}, [gameState.metadata.lastX, gameState.metadata.lastY, gameState.settings.shareMouse])\n\t*/\n\n\t/*\n\tuseEffect(() => {\n\t\t//TODO: reenable websocket push\n\t\t//if (websocket)\n\t\t//\twebsocket.pushTokens(gameState.game.tokens)\n\t}, [gameState.game.tokens])\n\t*/\n\n\t/****************************************************\n\t * Component Render                                 *\n\t ****************************************************/\n\tconst deadline = new Date() - 30000\n\tconst cursorsCopy = metadata.cursors\n\n\tfor (let name in cursorsCopy) {\n\t\tlet time = cursorsCopy[name].time\n\t\tif (!time || time < deadline)\n\t\t\tdelete cursorsCopy[name]\n\t}\n\n\ttry {\n\t\treturn (\n\t\t\t<GameView \n\t\t\t\tisHost={ metadata.isHost } \n\t\t\t\toverlayRef={ overlayRef } \n\t\t\t\tisFogLoaded={ game.isFogLoaded } \n\t\t\t\tcursors={ cursorsCopy } \n\t\t\t\tcursorSize={ settings.cursorSize } \n\t\t\t\ttokens={ game.tokens } \n\t\t\t\tonMouseMove={ onMouseMove } \n\t\t\t\tonMouseUp={ onMouseUp } \n\t\t\t\tonMouseDown={ onMouseDown } \n\t\t\t\t/* TODO: reenable notify={ notify } */\n\t\t\t/>\n\t\t)\n\t} catch (ex) {\n\t\thandleError(ex)\n\t}\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tmetadata: state.metadata,\n\t\tgame: state.game,\n\t\tsettings: state.settings,\n\t}\n}\n\nconst mapDispatchToProps = {\n\tsetGameSettings,\n\toverwriteGame,\n\tloadMap,\n\tupdateMaps,\n\taddMap,\n\tincrementGen,\n\tsetFogEnabled,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Game)\n","import React from 'react'\nimport { createStore, combineReducers } from 'redux'\nimport { Provider } from 'react-redux'\nimport settingsReducer from '../reducers/settingsReducer'\nimport metadataReducer from '../reducers/metadataReducer'\nimport gameReducer from '../reducers/gameReducer'\nimport WebSocketProvider from '../contexts/WebSocketProvider'\nimport Game from './Game'\n\nconst App = () => {\n    const combinedReducer = combineReducers({\n        settings: settingsReducer,\n        metadata: metadataReducer,\n        game: gameReducer,\n    })\n    const store = createStore(combinedReducer)\n\n    return(\n        <Provider store={ store } >\n            <WebSocketProvider>\n                <Game />\n            </WebSocketProvider>\n        </Provider>\n    )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.css'\nimport './styles/Game.css'\nimport App from './components/App'\nimport * as serviceWorker from './serviceWorker.js'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}